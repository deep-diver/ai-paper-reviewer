[{"figure_path": "2410.18234/figures/figures_4_0.png", "caption": "Optimal Approach for Multi-Draft Speculative Sampling", "description": "The figure illustrates the optimal approach for multi-draft speculative sampling, which consists of two steps. In the first step (Step 1), importance weighted sampling is used to select an intermediate token Y1 from a list of K candidate tokens (X1, ..., XK) generated by K draft models.  The selection is based on an optimized conditional distribution Pr(.), parameterized by \u03b2y(x1,...,xk). In the second step (Step 2), speculative sampling, using the target model, is applied to the selected token Y1 to generate the final output token Z.  The distribution of Z will match the target model distribution q(.).", "section": "3 TOKEN-LEVEL OPTIMAL DRAFT SELECTION: THEORETICAL ANALYSIS"}, {"figure_path": "2410.18234/figures/figures_24_0.png", "caption": "Optimal Approach for Multi-Draft Speculative Sampling", "description": "This figure illustrates the optimal two-step approach for multi-draft speculative sampling. In the first step, importance weighted sampling is used to select one intermediate token from K draft models.  In the second step, speculative sampling is performed using the target model, taking the selected token from the first step as input to generate the final output token.", "section": "3 TOKEN-LEVEL OPTIMAL DRAFT SELECTION: THEORETICAL ANALYSIS"}, {"figure_path": "2410.18234/figures/figures_35_0.png", "caption": "Figure 2: Numerical evaluation of Pr(accept) for the optimal scheme (Theorem 3) as well as two baseline schemes \u2013 SpecTr (Sun et al., 2024b) and SpecInfer (Miao et al., 2024). For sake of illustration we select alphabet \u03a9 = {1,2,3} and p = [1/3,1/3, 1/3]. The left plot sets q = [1/3, q2, 2/3-q2] while the right plot sets q = [1/6, q2, 5/6 - q2] where q2 is varied on the x-axis.", "description": "This figure shows two plots that numerically evaluate the acceptance probability for the optimal scheme presented in Theorem 3, and two baseline schemes: SpecTr and SpecInfer. Both plots use an alphabet \u03a9 of size 3, with a draft distribution p of [1/3, 1/3, 1/3]. The left plot varies the target distribution q as [1/3, q2, 2/3 - q2], while the right plot varies q as [1/6, q2, 5/6 - q2], in both cases showing Pr(accept) as a function of q2.  The plots show that the optimal scheme consistently achieves a higher acceptance probability than the baselines across a wide range of q2 values, demonstrating improved performance for multi-draft speculative sampling.", "section": "3 TOKEN-LEVEL OPTIMAL DRAFT SELECTION: THEORETICAL ANALYSIS"}]