[{"figure_path": "2410.21465/figures/figures_3_0.png", "caption": "Figure 2: Left: SHADOWKV enhances long-context LLM inference throughput by offloading the value cache to the CPU while maintaining a low-rank key cache, landmarks, and outliers on the GPU. During decoding, it employs landmarks for efficient sparse attention, reducing computation and data movement. Right: SHADOWKV effectively utilizes a limited KV budget to achieve high accuracy, theoretically reaching over 7 TB/s equivalent bandwidth on an A100, and empirically boosts generation throughput by 3.04\u00d7 for Llama-3.1-8B with on a batch of 122K contexts.", "description": "This figure illustrates the SHADOWKV system architecture, highlighting its key components and workflow for both pre-filling and decoding phases, and shows its performance gain in throughput.", "section": "4 SHADOWKV"}, {"figure_path": "2410.21465/figures/figures_5_0.png", "caption": "Figure 4: SHADOWKV pre-filling.", "description": "The figure illustrates the pre-filling stage of the SHADOWKV system, showing how low-rank key caches, landmarks, and outlier chunks are created and stored.", "section": "4 SHADOWKV"}, {"figure_path": "2410.21465/figures/figures_6_0.png", "caption": "Figure 2: Left: SHADOWKV enhances long-context LLM inference throughput by offloading the value cache to the CPU while maintaining a low-rank key cache, landmarks, and outliers on the GPU. During decoding, it employs landmarks for efficient sparse attention, reducing computation and data movement. Right: SHADOWKV effectively utilizes a limited KV budget to achieve high accuracy, theoretically reaching over 7 TB/s equivalent bandwidth on an A100, and empirically boosts generation throughput by 3.04\u00d7 for Llama-3.1-8B with on a batch of 122K contexts.", "description": "This figure illustrates the SHADOWKV system architecture, showing how it enhances long-context LLM inference throughput by offloading the value cache to the CPU and employing a low-rank key cache with landmarks and outliers for efficient sparse attention.", "section": "4 SHADOWKV"}]