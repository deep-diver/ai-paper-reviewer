[{"figure_path": "https://arxiv.org/html/2411.15139/x1.png", "caption": "Figure 1: The comparison of different end-to-end paradigms. (a) Single mode regression\u00a0[17, 13, 6]. (b) Sampling from vocabulary\u00a0[3, 22]. (c) Vanilla diffusion policy\u00a0[5, 16]. (d) The proposed truncated diffusion policy.", "description": "Figure 1 compares four different approaches to end-to-end autonomous driving. (a) shows a single-mode regression model, where the model directly predicts a single trajectory.  (b) illustrates a method that samples from a pre-defined vocabulary of trajectories, representing various driving behaviors. (c) depicts a vanilla diffusion model, which uses many denoising steps to generate diverse trajectories from random noise.  Finally, (d) presents the proposed 'truncated diffusion policy', which improves upon the vanilla diffusion model by incorporating pre-defined anchors and reducing the number of denoising steps to increase efficiency and generate more realistic driving actions.", "section": "1. Introduction"}, {"figure_path": "https://arxiv.org/html/2411.15139/x2.png", "caption": "(a) Top-1\u2019s going straight and diverse top-10\u2019s lane changing.", "description": "This figure shows a comparison of trajectory predictions by different methods on a challenging driving scenario from the NAVSIM dataset.  The left side shows the sampled noise used as input and the denoised trajectories generated by Transfuser, TransfuserDP, and DiffusionDrive. The right side shows the corresponding camera input and the ground truth trajectory (GT Traj). The top row (a) focuses on a scenario where the ground truth is going straight, and the bottom row (b) focuses on a scenario where the ground truth is turning left.  DiffusionDrive demonstrates superior performance by closely matching the ground truth trajectory and generating a diverse set of plausible alternative trajectories (top-10 scoring trajectories) that encompass various driving behaviors, such as lane changing, which were not observed in other methods.", "section": "Qualitative comparison"}, {"figure_path": "https://arxiv.org/html/2411.15139/x3.png", "caption": "(b) Top-1\u2019s turning left and diverse top-10\u2019s lane changing.", "description": "This figure (Figure 2(b)) shows a comparison of different model's trajectory prediction results on a challenging lane-changing scenario from the NAVSIM dataset.  The ground truth trajectory shows a vehicle turning left.  Transfuser produces only a single trajectory prediction, indicating a mode collapse issue.  TransfuserDP, while slightly better, still exhibits a lack of diversity in its trajectory predictions.  In contrast, DiffusionDrive predicts both a top-1 trajectory that accurately matches the ground truth, and diverse top-10 trajectories showcasing different, yet plausible, lane-changing maneuvers.  This demonstrates DiffusionDrive's capability to generate multiple high-quality, diverse driving actions.", "section": "Qualitative comparison"}, {"figure_path": "https://arxiv.org/html/2411.15139/x4.png", "caption": "Figure 2: Qualitative comparison of Transfuser, TransfuserDPDP{}_{\\text{DP}}start_FLOATSUBSCRIPT DP end_FLOATSUBSCRIPT and DiffusionDrive on challenging scenes of NAVSIM navtest split. With the same inputs from front cameras and LiDAR, DiffusionDrive achieves the highest planning quality of top-1 scoring trajectory as illustrated in Tab.\u00a02. We render the highlighted diverse trajectories predicted by DiffusionDrive in the front view. (a) and (b) shows that the top-1 scoring trajectory of DiffusionDrive closely matches the ground truth for both going straight and turning left. Additionally, DiffusionDrive\u2019s top-10 scoring trajectory demonstrates high-quality lane changing\u2014an ability not observed in multi-mode TransfuserDPDP{}_{\\text{DP}}start_FLOATSUBSCRIPT DP end_FLOATSUBSCRIPT and impossible for Transfuser.", "description": "Figure 2 showcases a qualitative comparison of three different methods for autonomous driving planning: Transfuser, TransfuserDP, and DiffusionDrive.  All three methods receive the same inputs from front-facing cameras and LiDAR sensors. The figure demonstrates that DiffusionDrive generates the highest-quality top-1 scoring trajectory, closely matching ground truth trajectories for both straight and turning maneuvers (as detailed in Table 2).  Furthermore, the figure highlights the diversity of DiffusionDrive's top-10 trajectories, exhibiting complex maneuvers such as lane changes\u2014a capability that neither Transfuser nor TransfuserDP possess. This visual comparison strongly supports the claim that DiffusionDrive outperforms the other methods.", "section": "3.2 Investigation"}, {"figure_path": "https://arxiv.org/html/2411.15139/x5.png", "caption": "Figure 3: Illustration of truncated diffusion policy by comparing with vanilla diffusion policy. We truncate the diffusion process and only add a small portion of Gaussian noise to diffuse the anchor trajectories. Then, we train the diffusion model to reconstruct the ground-truth trajectory from the anchored Gaussian distribution with conditional scene context. During the inference, we also truncate the denoising process by starting from the better samples in the anchored Gaussian distribution than the pure Gaussian noise.", "description": "This figure compares the vanilla diffusion policy with the proposed truncated diffusion policy.  The vanilla method starts with random Gaussian noise and iteratively denoises it towards the target trajectory over many steps.  In contrast, the truncated policy begins with a set of anchor trajectories representing common driving patterns.  Only a small amount of noise is added to these anchors, and the diffusion process is shortened to a much smaller number of steps.  Training involves learning to reconstruct ground-truth trajectories from these noisy anchor samples, considering scene context.  Inference also uses the truncated method, starting with the closest anchors to initial conditions, leading to faster and potentially more diverse results.", "section": "3. Method"}]