[{"figure_path": "https://arxiv.org/html/2411.00743/extracted/5971945/figures/sae_comparison_plot_final.png", "caption": "Figure 1: Pareto curves for Physics SSAE trained with various data selection strategies as the \u03bb\ud835\udf06\\lambdaitalic_\u03bb is varied on arXiv Physics test data. We plot (Left) Perplexity with spliced in SSAE relative to GSAE baseline and (Right) Absolute Perplexity with spliced in SSAE. Dense TracIn and BM25 TracIn achieve comparable performance, performing slightly better than Dense retrieval, which outperforms BM25 retrieval and OWT Baseline. All curves are averaged over three SAE training seeds.", "description": "This figure displays the performance of Sparse Autoencoders (SAEs) trained using different data selection strategies on a physics dataset.  Two key metrics are shown: perplexity (a measure of how well the SAE reconstructs the original data) and Lo sparsity (the average number of active features used in reconstruction). The left panel shows the relative perplexity compared to a general-purpose SAE baseline, while the right panel shows the absolute perplexity. The results indicate that using a combination of dense retrieval and TracIn reranking for data selection yields the best performance, slightly outperforming dense retrieval alone, which in turn is superior to BM25 retrieval and a baseline SAE trained on the full dataset.  The curves represent the average of three separate training runs for each data selection strategy.", "section": "3.1 Specialized Sparse Autoencoders (SSAEs)"}, {"figure_path": "https://arxiv.org/html/2411.00743/x3.png", "caption": "Figure 2: Proportion of tokens with SAE features vs. Token frequency in Physics arXiv data. SSAE trained with dense retrieval captures more tail tokens (concepts) in its features.", "description": "This figure shows the relationship between the frequency of tokens (words or sub-word units) in the Physics arXiv dataset and the proportion of those tokens that are represented by features in a Sparse Autoencoder (SAE).  The x-axis represents the frequency of tokens (log scale), indicating how often each token appears in the dataset. The y-axis represents the proportion of tokens of a given frequency that are encoded by at least one feature in the SAE.  A higher proportion indicates that the SAE effectively captures rarer tokens (tail concepts). The key finding is that an SAE trained using a dense retrieval method for data selection (SSAE) shows a noticeably higher proportion of tail tokens represented in its features compared to an SAE trained on general data, demonstrating its ability to capture rare concepts effectively.", "section": "3.1.2 Probing Tail Concept Learning"}, {"figure_path": "https://arxiv.org/html/2411.00743/extracted/5971945/figures/gsae_normalized_diversity_scores_distribution.png", "caption": "Figure 3: Reconstruction error vs. token rank for TERM-trained and ERM-trained GSAEs. TERM exhibits lower error variance and maximum error for tail tokens.", "description": "This figure compares the reconstruction error of tokens ranked by frequency for models trained with Tilted Empirical Risk Minimization (TERM) and standard Empirical Risk Minimization (ERM).  The x-axis represents token rank (from most frequent to least frequent), and the y-axis shows the reconstruction error. The plot demonstrates that the TERM-trained model achieves lower average reconstruction error and significantly lower maximum reconstruction error for low-frequency (tail) tokens compared to the ERM-trained model, indicating improved performance and robustness for less common concepts.", "section": "3.2 Tilted ERM for Enhanced Detection"}, {"figure_path": "https://arxiv.org/html/2411.00743/extracted/5971945/figures/merged.drawio.png", "caption": "Figure 4: Feature diversity score distributions for TERM-trained and ERM-trained GSAEs. TERM leads to both higher and lower diversity features. Lower diversity features specialize in tail concepts, while higher diversity features capture a broader range of concepts.", "description": "This figure shows the distributions of diversity scores for features extracted using Sparse Autoencoders (SAEs) trained with two different methods: Empirical Risk Minimization (ERM) and Tilted Empirical Risk Minimization (TERM).  The diversity score measures the range of concepts a feature represents.  The figure demonstrates that TERM leads to a wider range of feature diversity. Some TERM-trained SAE features are highly specific, focusing on rare concepts (tail concepts), while others are more general, covering a broader range of concepts. In contrast, ERM tends to produce features with intermediate diversity, not specializing in either tail concepts or broadly encompassing ones. This visualization highlights the effect of TERM in improving the representation of both frequent and infrequent concepts within the SAE feature space.", "section": "3.2 Tilted ERM for Enhanced Detection"}, {"figure_path": "https://arxiv.org/html/2411.00743/extracted/5971945/figures/tilt_tail_new_2_crop.png", "caption": "Figure 5: TERM feature activation patterns. (Left) TERM token activation entropy is lower, suggesting more specialized features. (Right) TERM max feature activations per token are higher. These characteristics, from minimizing max risk, contribute to TERM\u2019s enhanced tail concept detection.", "description": "This figure displays the effect of Tilted Empirical Risk Minimization (TERM) on the distribution of Sparse Autoencoder (SAE) features.  The left panel shows the entropy of token activations, demonstrating that TERM leads to lower entropy, implying more specialized features focused on individual concepts. The right panel shows the maximum activation value per token, indicating that TERM results in higher maximum activations.  This combination of lower entropy and higher maximum activation suggests that TERM effectively prioritizes learning rarer features. In essence, TERM improves the ability of the model to learn and represent less frequent, yet potentially important, concepts. ", "section": "3.2 Tilted ERM for Enhanced Detection"}, {"figure_path": "https://arxiv.org/html/2411.00743/extracted/5971945/figures/tilt_log_log_camera_ready.png", "caption": "Figure 6: Cumulative proportion of tokens with SAE features vs. cumulative percentage of tokens in Physics arXiv data, normalized per model so that the cumulative proportion of tokens with features is 1 over the entire dataset. SSAE trained with dense retrieval and larger tilt captures more tail tokens (concepts) in its features.", "description": "This figure shows the cumulative distribution of tokens with features identified by Sparse Autoencoders (SAEs) against the cumulative distribution of token frequencies in the Physics arXiv dataset.  Each curve is normalized so that the cumulative proportion of tokens with features sums to 1 across the entire dataset, enabling direct comparison of coverage across different SAE training methods.  The results demonstrate that SAEs trained using the Dense Retrieval method with a higher tilt parameter capture a greater proportion of tail tokens (those with lower frequencies), indicating their effectiveness in identifying rare concepts within the dataset.", "section": "3.1 Specialized Sparse Autoencoders (SSAEs)"}, {"figure_path": "https://arxiv.org/html/2411.00743/extracted/5971945/figures/f1_score_distributions_large.png", "caption": "Figure 7: Feature activation count vs. feature rank for SSAEs trained on the Physics arXiv dataset using different strategies: full OWT, Dense retrieval, and Dense retrieval with tilt. Tilt encourages the learning of more broadly activating features, indicating increased concept coverage and recall.", "description": "This figure presents Pareto curves illustrating the trade-off between sparsity (measured by L0) and perplexity for Sparse Autoencoders (SAEs) trained using different data selection strategies on the Physics arXiv dataset. The strategies include training on the full OpenWebText corpus, using Dense Retrieval to select subdomain-relevant data, and employing Dense Retrieval in conjunction with a tilt parameter for Tilted Empirical Risk Minimization (TERM). The plot demonstrates that using Dense Retrieval with TERM (i.e., applying tilt) results in SAEs that learn features which activate more broadly across the dataset, compared to the other strategies. This increased breadth of activation is indicative of enhanced concept coverage and recall. By using TERM, the model focuses on minimizing the maximum loss rather than the average loss, which encourages it to capture rarer, less frequent concepts.", "section": "3.1.1 Data Selection Strategies"}, {"figure_path": "https://arxiv.org/html/2411.00743/x4.png", "caption": "Figure 8: Automated interpretability:\nF1 score distributions for predicting feature activation on Physics arXiv, using only FM-generated explanations. An LM is given examples activating a feature and asked to generate an explanation, which is then used to predict activations on new examples. Dense retrieval with tilt produces more predictive explanations than both the OWT baseline and Dense retrieval alone.", "description": "This figure displays the F1 scores achieved when using language model generated explanations to predict feature activation in a physics model.  The x-axis represents the F1 score (a measure of prediction accuracy), and the y-axis represents the probability density, showing how often a given F1 score was obtained. The results are presented for different training methods: a baseline model trained on a general-purpose dataset (OWT), a model trained using dense retrieval, and a model trained using dense retrieval with a tilt parameter. The figure demonstrates that the model trained using dense retrieval with a tilt parameter produces significantly more accurate predictions (higher F1 score) compared to models trained using other methods. This is evidence of improved interpretability through this particular training technique.", "section": "3.2.3 Automated Interpretability"}, {"figure_path": "https://arxiv.org/html/2411.00743/extracted/5971945/figures/sae_comparison_plot_toxicity_adjusted_camera_ready.png", "caption": "Figure 9: Pareto curves for SSAE trained with various data selection strategies as the sparsity coefficient is varied on Physics instruction test data. We plot absolute perplexity with the spliced in SSAE. We find that both BM25 retrieval and training on the validation data generalize poorly when tested out of domain. All curves are averaged over three SAE training run seeds.", "description": "This figure displays Pareto curves, which show the trade-off between sparsity and reconstruction error, for Sparse Autoencoders (SAEs) trained using different data selection strategies.  The x-axis represents the average number of active features (sparsity), and the y-axis represents the perplexity (a measure of reconstruction error) when the SAE's reconstruction is used in a language model. The different curves represent SAEs trained with different methods for selecting training data: BM25 retrieval, Dense Retrieval, BM25 TracIn, Dense TracIn, and using the full dataset.  The results show that training the SAE on a carefully curated dataset (using TracIn for example) leads to better generalization performance when compared to models trained using only the validation data or the full dataset.  The poor performance when tested outside of the training data distribution (out-of-domain) highlights the importance of effective data selection for achieving robust and reliable SAEs.", "section": "3.1 Specialized Sparse Autoencoders (SSAEs)"}, {"figure_path": "https://arxiv.org/html/2411.00743/x5.png", "caption": "Figure 11: Proportion of tokens with SAE features vs. Token frequency in Toxicity data. SSAE trained with dense retrieval captures more tail tokens (concepts) in its features.", "description": "This figure shows the relationship between the frequency of tokens (words or sub-word units) in a toxicity dataset and the proportion of those tokens that are represented by features in a Sparse Autoencoder (SAE).  The x-axis represents the frequency of tokens, while the y-axis shows the percentage of tokens with a given frequency that are encoded by at least one feature in the SAE.  A higher value on the y-axis at lower token frequencies indicates better representation of rare (tail) concepts in the dataset. The results show that an SAE trained with a dense retrieval method (which helps to focus on relevant subdomain data) is able to capture a greater proportion of these rare tokens compared to a standard SAE trained on general data, confirming the effectiveness of this specialized approach for interpreting rare concepts.", "section": "3.1.2 Probing Tail Concept Learning"}, {"figure_path": "https://arxiv.org/html/2411.00743/x6.png", "caption": "Figure 12: Pareto curves for SSAEs finetuned on the Physics arXiv dataset using different strategies: full OpenWebText (OWT), Dense retrieval, and Dense retrieval with Tilted Empirical Risk Minimization (TERM, tilt=500 and TERM, tilt=109superscript10910^{9}10 start_POSTSUPERSCRIPT 9 end_POSTSUPERSCRIPT). TERM-finetuned SSAEs achieve competitive performance with Dense retrieval alone within the L0subscript\ud835\udc3f0L_{0}italic_L start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT range of 85-100. Outside this range, our current training methodology results in higher reconstruction errors. All curves are averaged over three SAE training run seeds.", "description": "This figure displays Pareto curves illustrating the trade-off between sparsity (L0) and perplexity for Sparse Autoencoders (SAEs) fine-tuned on a physics dataset.  Different data selection strategies are compared: using the entire OpenWebText corpus (OWT), using dense retrieval, and using dense retrieval combined with Tilted Empirical Risk Minimization (TERM) at tilt values of 500 and 10\u2079. The results show that SAEs trained with TERM achieve performance comparable to dense retrieval alone within a specific L0 range (85-100).  Outside this range, reconstruction errors increase, indicating limitations of the current training approach.  The curves are averages across multiple runs to increase reliability.", "section": "3.1 Specialized Sparse Autoencoders (SSAEs)"}, {"figure_path": "https://arxiv.org/html/2411.00743/extracted/5971945/figures/sae_normalized_cumulative_distribution_plot_log_matplotlib.png", "caption": "Figure 13: Pareto curves for SSAEs finetuned on the Toxicity dataset using different strategies: full OpenWebText (OWT), Dense retrieval, and Dense retrieval with Tilted Empirical Risk Minimization (TERM, tilt=500). TERM-finetuned SSAEs achieve competitive performance with Dense retrieval alone within the L0subscript\ud835\udc3f0L_{0}italic_L start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT range of 100-140. All curves are averaged over three SAE training run seeds.", "description": "This figure presents Pareto curves illustrating the trade-off between sparsity (L0) and reconstruction error (perplexity) for Sparse Autoencoders (SAEs) fine-tuned on the Pile Toxicity dataset.  Different data selection strategies were employed for training the SAEs: using the full OpenWebText corpus (OWT), using dense retrieval to select relevant data, and using dense retrieval combined with Tilted Empirical Risk Minimization (TERM) at a tilt of 500.  The Pareto curves show that SAEs trained with dense retrieval and TERM achieve comparable performance to those trained with dense retrieval alone but only within a specific range of sparsity levels (L0 between 100 and 140).  The results are averaged over multiple runs to provide a robust comparison.", "section": "3.2 Tilted ERM for Enhanced Detection"}, {"figure_path": "https://arxiv.org/html/2411.00743/x7.png", "caption": "Figure 14: Cumulative proportion of tokens with SAE features vs. cumulative percentage of tokens in Toxicity data, normalized per model so that the cumulative proportion of tokens with features is 1 over the entire dataset. SSAE trained with dense retrieval and larger tilt captures more tail tokens (concepts) in its features. Note that the curves at tilt 500 and tilt 109superscript10910^{9}10 start_POSTSUPERSCRIPT 9 end_POSTSUPERSCRIPT overlap.", "description": "This figure shows the cumulative distribution of tokens with features extracted by Sparse Autoencoders (SAEs) compared to the cumulative distribution of token frequency in the Pile Toxicity dataset.  The x-axis represents the cumulative percentage of tokens (from least to most frequent), and the y-axis represents the cumulative proportion of tokens having features according to the SAEs.  Three different SAE training methods are shown: one trained on the entire dataset (baseline), one trained using dense retrieval of relevant tokens, and one trained using dense retrieval and the Tilted Empirical Risk Minimization (TERM) training objective with two different tilt parameters (500 and 10^9).  The plot illustrates that SAEs trained with dense retrieval and TERM (especially with the higher tilt value) capture a significantly greater proportion of less frequent tokens (tail concepts) than the baseline SAE trained on the full dataset. The curves for the TERM models with tilt=500 and tilt=10^9 are nearly overlapping, suggesting that the improvement from increasing the tilt parameter beyond 500 may be marginal.", "section": "3.2 Tilted ERM for Enhanced Detection"}, {"figure_path": "https://arxiv.org/html/2411.00743/x8.png", "caption": "Figure 15: The full annotated feature circuit discovered for the Bias in Bios classifier with the GSAE patched in. The circuit was discovered using TN=0.1subscript\ud835\udc47\ud835\udc410.1T_{N}=0.1italic_T start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT = 0.1 and TE=0.01subscript\ud835\udc47\ud835\udc380.01T_{E}=0.01italic_T start_POSTSUBSCRIPT italic_E end_POSTSUBSCRIPT = 0.01. We observe that the circuit contains many nodes that simply detect the presence of gendered pronouns or gendered names. A few features attend to profession information, including one which activates on words related to nursing, and another that activates on passages relating to science and academia.", "description": "This figure shows a sparse feature circuit, a graph illustrating the relationships between features extracted from a sparse autoencoder (SAE) and a model's classification decisions, specifically for a bias detection task using the Bias in Bios dataset. The circuit highlights which SAE features are most influential in predicting whether a person is a nurse or a professor. It reveals that many features are focused on detecting gendered pronouns and names, indicating potential biases. However, some features do relate to the professions, for example, there is a feature for words related to nursing and another for words associated with science and academia.", "section": "3.1.3 Case study: Removing Spurious Features in Bias in Bios Classifier"}, {"figure_path": "https://arxiv.org/html/2411.00743/x9.png", "caption": "Figure 16: The full annotated feature circuit for the Bias in Bios classifier with the finetuned SSAE patched in. The circuit was discovered using TN=0.1subscript\ud835\udc47\ud835\udc410.1T_{N}=0.1italic_T start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT = 0.1 and TE=0.01subscript\ud835\udc47\ud835\udc380.01T_{E}=0.01italic_T start_POSTSUBSCRIPT italic_E end_POSTSUBSCRIPT = 0.01. This circuit is much larger due to newly activated features in the SSAE that detect the presence of gendered pronouns and gendered names, as well as features for profession information such as nursing and academia.", "description": "This figure shows a feature circuit diagram for a Bias in Bios classifier.  The classifier uses a Specialized Sparse Autoencoder (SSAE) which is a modified version of a standard Sparse Autoencoder (SAE) trained to focus on specific subdomains. The diagram visually represents how the SSAE's features relate to the classifier's predictions.  Because it is trained on subdomains, it has many more activated features than the standard SAE.  These features detect gendered pronouns, names, and profession-related terms such as \"nursing\" and \"academia\". The circuit's size is a consequence of the SSAE's improved ability to capture rare concepts. The parameters T<sub>N</sub> = 0.1 and T<sub>E</sub> = 0.01 control the thresholds for node and edge selection, respectively.", "section": "3.1.3 Case study: Removing Spurious Features in Bias in Bios Classifier"}, {"figure_path": "https://arxiv.org/html/2411.00743/x10.png", "caption": "Figure 17: Distribution of log-ratio feature activation count differences between specialized SAEs and the OWT baseline on the Physics arXiv test set, normalized per SAE model. Blue represents the ERM-trained SSAE with Dense retrieval, orange represents the TERM-trained SSAE with tilt=500. The ERM-trained SSAE exhibits more probability mass on the right, indicating an emphasis on representing common concepts, while the TERM-trained SSAE\u2019s shift towards the left suggests a greater focus on representing domain-specific tail concepts.", "description": "This figure shows the distribution of differences in the number of times each feature was activated, comparing specialized sparse autoencoders (SAEs) trained with Empirical Risk Minimization (ERM) and Tilted Empirical Risk Minimization (TERM) against a general-purpose SAE.  The x-axis represents the log-ratio of the feature activation counts in the specialized SAEs relative to the general-purpose SAE. Positive values indicate features more frequently activated in specialized SAEs.  The distribution for the ERM-trained SAE is skewed right, signifying that it favors common concepts.  In contrast, the distribution for the TERM-trained SAE is shifted to the left, indicating a stronger focus on less frequent, domain-specific concepts.  This highlights how TERM helps SAEs capture rare concepts.", "section": "3.2 Tilted ERM for Enhanced Detection"}, {"figure_path": "https://arxiv.org/html/2411.00743/x11.png", "caption": "Figure 18: Distribution of log-ratio feature activation count differences on the Physics arXiv test set, normalized per SAE model. Blue represents the ERM-trained SSAE with Dense retrieval, orange represents the TERM-trained SSAE with tilt=109superscript10910^{9}10 start_POSTSUPERSCRIPT 9 end_POSTSUPERSCRIPT. The intensified leftward shift of probability mass with higher tilt demonstrates that TERM increasingly prioritizes representing tail concepts compared to standard ERM-trained SSAE, which focuses more on frequent concepts.", "description": "Figure 18 shows the distribution of the difference in the number of times features are activated between specialized sparse autoencoders (SAEs) trained with empirical risk minimization (ERM) and tilted empirical risk minimization (TERM), and a general-purpose SAE.  The data is from the arXiv Physics test set, and the results are normalized per SAE model.  The blue curve represents ERM-trained SAEs using dense retrieval, while the orange curve shows TERM-trained SAEs with a tilt parameter of 10<sup>9</sup>.  The plot demonstrates that TERM increasingly emphasizes rarer concepts (tail concepts) compared to ERM, which prioritizes more frequent concepts (head concepts).  The greater leftward shift in the orange curve for TERM at tilt 10<sup>9</sup> visually represents the increased focus on rarer concepts. ", "section": "3.2 Tilted ERM for Enhanced Detection"}, {"figure_path": "https://arxiv.org/html/2411.00743/x12.png", "caption": "Figure 19: UMAP visualization of token activations and decoder features for a TERM-trained and ERM-trained GSAE. Decoder directions for TERM-trained GSAE appear more spread out, suggesting the SAE has wider coverage than the ERM-trained GSAE.", "description": "This figure displays a UMAP visualization comparing the token activations and decoder directions learned by two types of Sparse Autoencoders (SAEs): one trained using standard Empirical Risk Minimization (ERM), and the other trained using Tilted Empirical Risk Minimization (TERM). The UMAP projection shows the decoder directions for the TERM-trained SAE are more spread out than those of the ERM-trained SAE. This indicates that the TERM-trained SAE has learned a more diverse set of features, covering a wider range of concepts and capturing more of the nuances in the data compared to the ERM-trained SAE. The wider spread of features suggests that TERM is more effective at capturing tail concepts (rare, infrequent features) that would be missed by a standard ERM-trained SAE.", "section": "3.2 Tilted ERM for Enhanced Detection"}, {"figure_path": "https://arxiv.org/html/2411.00743/extracted/5971945/figures/token_coverage_comparison.png", "caption": "Figure 20: Distribution of cosine similarities between decoder directions of TERM-trained and ERM-trained GSAEs. TERM-trained GSAE shows lower similarity between decoder feature directions implying greater coverage.", "description": "This figure displays the distribution of cosine similarity scores between the decoder directions learned by two different types of generative sparse autoencoders (GSAEs): one trained with Empirical Risk Minimization (ERM), and the other trained with Tilted Empirical Risk Minimization (TERM).  The cosine similarity measures how similar the learned feature vectors are.  A lower average cosine similarity indicates that the TERM-trained GSAE has learned more diverse and distinct feature directions, implying that it has captured a wider range of concepts from the data.", "section": "3.2 Tilted ERM for Enhanced Detection"}]