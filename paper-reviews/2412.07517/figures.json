[{"figure_path": "https://arxiv.org/html/2412.07517/x6.png", "caption": "Figure 1: FireFlow for Image Inversion and Editing in 8 Steps. Our approach achieves outstanding results in semantic image editing and stylization guided by prompts, while maintaining the integrity of the reference content image and avoiding undesired alterations. [+]/[-] means adding or removing contents, [C] indicates changes in visual attributes (style, material, or texture), and [R] denotes content or gesture replacements.", "description": "Figure 1 showcases the application of FireFlow for image inversion and editing within 8 steps.  The examples demonstrate semantic image editing and stylizations using prompts while preserving the original image content, covering various modifications like adding or removing content ([+]/[-]), changing visual attributes ([C]), and replacing existing content or gestures ([R]).", "section": "Abstract"}, {"figure_path": "https://arxiv.org/html/2412.07517/x7.png", "caption": "(a) Euler Method (NFE=20NFE20\\text{NFE}=20NFE = 20)", "description": "This figure presents a comparison of different numerical solvers for 2-Rectified Flow on a 2D synthetic dataset. The dataset consists of two distributions: a source distribution (orange) and a target distribution (green), both parameterized as Gaussian mixture models.  The Euler Method, Midpoint Method, and the proposed method are compared, all using 20 NFEs (Number of Function Evaluations). The trajectories of samples during the transformation are visualized. The purpose is to demonstrate that the proposed method generates samples that better align with the target distribution in terms of density and structure, and the trajectories are straighter, indicating closer adherence to the ideal linear motion.", "section": "4. Method"}, {"figure_path": "https://arxiv.org/html/2412.07517/x8.png", "caption": "(b) Midpoint Method (NFE=20NFE20\\text{NFE}=20NFE = 20)", "description": "Figure 2(b) depicts the behavior of a 2D Rectified Flow model when using the standard midpoint method for numerical integration. The midpoint method enhances accuracy over simpler first-order methods by evaluating the flow's velocity at the midpoint of each time step. The visualization demonstrates the trajectories of samples as they transition between two distributions. Orange represents the source distribution, green the target, and blue the flow\u2019s estimate after transformation. Notably, the trajectories exhibit a degree of curvature, reflecting the second-order nature of the midpoint method. The NFE = 20 specifies that the velocity function was evaluated 20 times during the sampling process, influencing both the computational cost and accuracy of the result.", "section": "4. Method"}, {"figure_path": "https://arxiv.org/html/2412.07517/extracted/6059042/fireflow/fig/academic_plot_blue.png", "caption": "(c) Ours (NFE=20NFE20\\text{NFE}=20NFE = 20)", "description": "This subfigure shows the results on a 2D synthetic dataset using the proposed FireFlow approach with NFE=20. The proposed approach generates samples that better align with the target distribution compared to Euler Method and Midpoint Method, both visually and in terms of density and structure. The trajectories of the samples generated by FireFlow are straighter, closely adhering to the ideal linear motion principle.", "section": "4. Method"}, {"figure_path": "https://arxiv.org/html/2412.07517/x9.png", "caption": "Figure 2: Results on 2D synthetic dataset. We evaluate the performance of 2-Rectified Flow using the Euler solver, midpoint solver, and our proposed approach on a 2D synthetic dataset. The source distribution \u03c00subscript\ud835\udf0b0\\pi_{0}italic_\u03c0 start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT (orange) and the target distribution \u03c01subscript\ud835\udf0b1\\pi_{1}italic_\u03c0 start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT (green) are parameterized as Gaussian mixture models. For the Euler method, the number of sampling steps is set to N=20\ud835\udc4120N=20italic_N = 20, corresponding to an NFE of 20. Our approach generates samples that align more closely with the target distribution, achieving a better match in density and structure. Additionally, the trajectories of the samples exhibit greater straightness, adhering closely to the ideal of linear motion.", "description": "This figure visualizes the results of applying three different numerical solvers (Euler, Midpoint, and the proposed method) to a 2D synthetic dataset using 2-Rectified Flow. The goal is to transform samples from a source distribution (orange) to a target distribution (green), both parameterized as Gaussian mixture models.  The figure demonstrates that the proposed method achieves a better match in density and structure with the target distribution, and generates straighter trajectories, indicating closer adherence to the ideal of linear motion, all while using the same number of function evaluations (NFE) as the Euler method and fewer NFEs than the midpoint method.", "section": "Method"}, {"figure_path": "https://arxiv.org/html/2412.07517/extracted/6059042/fireflow/fig/pie_src/000000000005.jpg", "caption": "(a) Inversion and Reconstruction with Step=10", "description": "This subfigure presents an analysis of the approximation error in velocity (represented as ||v_hat - v||) during the inversion and reconstruction process with 10 steps. The graph showcases how this error changes with respect to the inversion and denoising steps. The value of delta_t is also displayed for reference, allowing for a comparison between the approximation error and the step size used in the numerical integration.", "section": "5.3. Inversion and Reconstruction"}, {"figure_path": "https://arxiv.org/html/2412.07517/extracted/6059042/fireflow/fig/pie_fireflow/000000000005.jpg", "caption": "(b) Inversion and Reconstruction with Step=20", "description": "This subfigure shows the relationship between the approximation error in velocity and the number of inversion (left) and denoising (right) steps with 20 steps settings. The x-axis represents the steps, while the y-axis shows the magnitude of the error. Notably, the error magnitude remains relatively stable and under control. This figure helps to confirm the robustness of the proposed velocity approximation method during the inversion and reconstruction processes.", "section": "5. Experiment"}, {"figure_path": "https://arxiv.org/html/2412.07517/extracted/6059042/fireflow/fig/pie_src/000000000014.jpg", "caption": "Figure 3: Illustrations of the approximation error in velocity (\u2016v^\u03b8\u2212v\u03b8\u2016normsubscript^\ud835\udc63\ud835\udf03subscript\ud835\udc63\ud835\udf03\\|\\hat{v}_{\\theta}-v_{\\theta}\\|\u2225 over^ start_ARG italic_v end_ARG start_POSTSUBSCRIPT italic_\u03b8 end_POSTSUBSCRIPT - italic_v start_POSTSUBSCRIPT italic_\u03b8 end_POSTSUBSCRIPT \u2225) as it evolves with inversion steps (left subfigures) and denoising steps (right subfigures), with \u0394\u2062t\u0394\ud835\udc61\\Delta troman_\u0394 italic_t included as a reference.", "description": "This figure illustrates the approximation error in velocity (the difference between the approximated velocity and the true velocity) during both the inversion and denoising steps of a rectified flow model. The error is plotted against the step number, and the time step size (\u0394t) is included as a reference. The left subfigures show the error during inversion (mapping from image to noise), while the right subfigures show the error during denoising/reconstruction (mapping from noise back to image).  The purpose is to demonstrate that the approximation error is well-controlled and scales proportionally with the time step, supporting the theoretical analysis.", "section": "4. Method"}, {"figure_path": "https://arxiv.org/html/2412.07517/extracted/6059042/fireflow/fig/pie_fireflow/000000000014.jpg", "caption": "Figure 4: Image reconstruction errors versus denoising NFE: Our approach, compared to the first-order vanilla ReFlow inversion and second-order RF-solver, achieves lower reconstruction errors and demonstrates faster convergence with respect to NFE.", "description": "This figure compares the reconstruction error of different ReFlow inversion methods as a function of the number of Neural Function Evaluations (NFEs). The plot shows that the proposed method achieves significantly lower reconstruction errors compared to both the first-order vanilla ReFlow inversion and the second-order RF-Solver.  Furthermore, the proposed method converges much faster to the minimal reconstruction error requiring fewer NFE for a given error tolerance.", "section": "5.3. Inversion and Reconstruction"}, {"figure_path": "https://arxiv.org/html/2412.07517/extracted/6059042/fireflow/fig/pie_src/000000000025.jpg", "caption": "Figure 5: Qualitative results of image reconstruction. Our approach achieves faster convergence and superior reconstruction quality compared to baseline ReFlow methods utilizing the FLUX model. Difference images showing the pixel-wise variations between the source image and the reconstructed images are also provided.", "description": "This figure presents a qualitative comparison of image reconstruction results using different ReFlow-based methods with the FLUX model. The first column displays the original source image and its corresponding text prompt.  Subsequent columns showcase the reconstructed images generated by Vanilla ReFlow, RF-Inversion, RF-Solver, and our proposed FireFlow method. The last row provides difference images (pixel-wise variations) between the source and reconstructed images for each method, highlighting the reconstruction fidelity.  The comparison demonstrates our method's superior reconstruction quality and faster convergence compared to the baselines.", "section": "5.3. Inversion and Reconstruction"}, {"figure_path": "https://arxiv.org/html/2412.07517/extracted/6059042/fireflow/fig/pie_fireflow/000000000025.jpg", "caption": "Figure 6: Comparison with State-of-the-art editing methods.", "description": "This figure presents a qualitative comparison of our proposed FireFlow method with other state-of-the-art image editing techniques.  Examples are shown for several different input images and editing prompts, and the results of each method are displayed side-by-side for comparison. The baseline methods include both diffusion-based methods (Prompt-to-Prompt, Pix2Pix-Zero, MasaCtrl, Plug-and-Play, PnP-Inv, and DiffEdit) and ReFlow-based methods (RF-Inversion and RF-Solver).", "section": "5. Experiment"}, {"figure_path": "https://arxiv.org/html/2412.07517/extracted/6059042/fireflow/fig/pie_src/000000000005.jpg", "caption": "Figure 7: Visualization of the convergence rate of different order inversion and reconstruction method. With 60 NFE, our approach still enjoys the lowest reconstruction error and the fast convergence speed.", "description": "This figure visualizes the convergence speed during image reconstruction across different numerical solvers using a fixed random seed. The x-axis represents the Number of Function Evaluations (NFEs), which serves as a proxy for computational cost. The y-axis represents the Root Mean Square Error (RMSE) between the reconstructed image and the original image. Lower RMSE values indicate better reconstruction quality. Three solvers are compared: first-order 'Vanilla ReFlow,' the proposed second-order method ('Ours'), and another second-order method 'RF-Solver.' The results demonstrate that the proposed method converges faster to a lower RMSE than the other methods, indicating more accurate and efficient image reconstruction.", "section": "C. Empirical Convergence Rate"}, {"figure_path": "https://arxiv.org/html/2412.07517/extracted/6059042/fireflow/fig/pie_fireflow_v2/000000000005.jpg", "caption": "Figure 8: Ablation Study on the Number of Editing Steps.", "description": "This figure presents an ablation study showcasing the impact of varying the number of denoising steps during image editing with FireFlow.  A source image of a cake is edited to include cherries on top. Results for 2, 4, 6, 8, 10, and 12 steps are visualized. The study demonstrates that while fewer steps (e.g., 2) hinder effective prompt incorporation, increasing the steps progressively enhances editing performance.  A point of diminishing returns is observed, with 8 steps offering comparable results to higher step counts, indicating sufficient prompt integration is achieved at this point.", "section": "5. Experiment\n5.4. Inversion-based Semantic Image Editing"}, {"figure_path": "https://arxiv.org/html/2412.07517/extracted/6059042/fireflow/fig/pie_src/000000000014.jpg", "caption": "(a) Source Image", "description": "The original image before any edits or transformations are applied, serving as the starting point for subsequent steps in the image manipulation process.  It depicts a cat sitting on a wall.", "section": "E. Ablation Study"}, {"figure_path": "https://arxiv.org/html/2412.07517/extracted/6059042/fireflow/fig/pie_fireflow_v2/000000000014.jpg", "caption": "(b) Black Cat", "description": "Edited Image: An edited image of the original cat where it becomes black.", "section": "5.4. Inversion-based Semantic Image Editing"}, {"figure_path": "https://arxiv.org/html/2412.07517/extracted/6059042/fireflow/fig/pie_src/000000000025.jpg", "caption": "(c) Source Image", "description": "An example image from the PIE-Bench dataset in its original state. The girl has brown hair and a neutral expression.  This serves as the 'before' image for demonstrating semantic editing using ReFlow and FireFlow.  The goal of editing would be to change aspects of the image according to a text prompt while minimizing distortion in non-edited regions.", "section": "5.4. Inversion-based Semantic Image Editing"}, {"figure_path": "https://arxiv.org/html/2412.07517/extracted/6059042/fireflow/fig/pie_fireflow_v2/000000000025.jpg", "caption": "(d) Raising Hands", "description": "The figure shows the result of applying the \"raising hands\" edit to an image of a man in a black shirt using FireFlow. The original image features the man with his arms at his sides, while the edited image shows him with both arms raised above his head.", "section": "5.4. Inversion-based Semantic Image Editing"}]