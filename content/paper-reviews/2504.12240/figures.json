[{"figure_path": "https://arxiv.org/html/2504.12240/x1.png", "caption": "Figure 1. \nCobra is a novel efficient long-context fine-grained ID preservation framework for line art colorization, achieving high precision, efficiency, and flexible usability for comic colorization. By effectively integrating extensive contextual references, it transforms black-and-white line art into vibrant illustrations.", "description": "This figure demonstrates the capabilities of the Cobra framework for line art colorization.  It showcases how Cobra takes black and white line art (input) and, using a large pool of reference images, generates vibrant and detailed color illustrations (output). The example highlights Cobra's ability to maintain high precision, efficiency, and flexibility in handling the complexities of colorizing comic book style art, including diverse characters, backgrounds, and styles, while preserving fine-grained identity details.", "section": "Introduction"}, {"figure_path": "https://arxiv.org/html/2504.12240/x2.png", "caption": "Figure 2. \nThe overview of Cobra.\nThis figure depicts the framework of Cobra, which utilizes a large collection of retrieved reference images to guide the colorization of comic line art. The framework effectively manages an arbitrary number of contextual image references through localized reusable positional encoding, ensuring appropriate aspect ratios and resolutions. Additionally, the causal sparse DiT architecture processes long contextual references, enhancing identity preservation and color accuracy while reducing computational complexity. The integration of optional color hints further ensures user flexibility, culminating in high-quality coloring that is highly suitable for industrial applications.", "description": "Cobra, a novel framework for efficient long-context line art colorization, is illustrated.  The figure details how Cobra uses many reference images to colorize comic-style line art.  It leverages localized reusable positional encoding to handle an arbitrary number of references and maintain proper aspect ratios.  Furthermore, a Causal Sparse DiT architecture efficiently manages long-context references for enhanced identity preservation and color accuracy, reducing computational cost. Optional color hints add user control and flexibility. The overall outcome is high-quality colorization ideal for industrial applications.", "section": "3 METHOD"}, {"figure_path": "https://arxiv.org/html/2504.12240/x3.png", "caption": "Figure 3. \nIllustration of the transition from Full Attention to Causal Sparse Attention. This figure highlights the reduction in computational complexity achieved by excluding pairwise calculations among reference images. Additionally, the application of unidirectional causal attention, along with the use of KV-Cache, further enhances computational efficiency while ensuring effective transmission of essential color ID information.", "description": "Figure 3 illustrates how Cobra improves efficiency by modifying the attention mechanism.  Traditional full attention calculates relationships between all pairs of elements (e.g., reference images and line art), leading to high computational cost, especially with many references.  Cobra's Causal Sparse Attention eliminates redundant pairwise calculations among reference images.  It uses unidirectional causal attention (information flows in one direction, like in a sentence) and a KV-Cache (key-value cache to store and reuse intermediate results) which significantly improves speed and reduces memory usage, while still effectively transmitting crucial color identity information.", "section": "3 METHOD"}, {"figure_path": "https://arxiv.org/html/2504.12240/x4.png", "caption": "Figure 4. An example of line art style augmentation, demonstrating the blending of outputs from two distinct line art extractors. This strategy improves the robustness of the Line Art Guider to diverse artistic styles.", "description": "Figure 4 illustrates the technique of line art style augmentation used in the Cobra model.  It shows how outputs from two different line art extractors are blended together. This process enhances the model's ability to handle diverse artistic styles in the input line art, making the Line Art Guider more robust and less sensitive to variations in style.", "section": "3.3 Line Art Guider"}, {"figure_path": "https://arxiv.org/html/2504.12240/x5.png", "caption": "Figure 5. Hint Point Sampling Strategy. This method reduces ambiguity by limiting the RGB pixel value variance within hint points to 0.01, effectively preventing hint points from being placed at edge intersections during training. Additionally, we visualize 30,000 randomly sampled hint points to demonstrate their distribution.", "description": "Figure 5 illustrates the Hint Point Sampling Strategy employed to mitigate ambiguity in color hint placement during training.  The strategy limits the variance of RGB pixel values within each hint point to a maximum of 0.01. This constraint prevents hint points from being inadvertently placed on edges, where color transitions are ambiguous and potentially lead to erroneous colorization results. The figure also visually represents the distribution of 30,000 randomly selected hint points, showcasing the strategy's effectiveness in achieving a balanced and meaningful distribution of hints across the image.", "section": "3 METHOD"}, {"figure_path": "https://arxiv.org/html/2504.12240/x6.png", "caption": "Figure 6. Qualitative results of line art colorization, highlighting how Cobra\u00a0 outperforms other methods by accurately preserving color IDs and providing high-quality results, even in complex scenarios.", "description": "Figure 6 presents a qualitative comparison of line art colorization results generated by Cobra and other existing methods.  It showcases several examples of complex line art illustrations (comics) and their corresponding colorized versions. The figure directly highlights Cobra's superior performance in accurately maintaining consistent colors for specific objects and characters (color ID preservation), while simultaneously producing high-quality, visually appealing colorized images, even when the line art is intricate or contains many elements.  This demonstrates that Cobra is robust and effective in handling the challenges of industrial-scale comic colorization tasks.", "section": "4 Experiments"}, {"figure_path": "https://arxiv.org/html/2504.12240/x7.png", "caption": "Figure 7. Qualitative results of line art with shadows, showcasing Cobra\u00a0\u2019s superior ability to maintain color fidelity and enhance detail, demonstrating its robustness and effectiveness in real-world applications.", "description": "Figure 7 presents a comparative analysis of line art colorization results, focusing on scenes containing shadows.  It showcases Cobra's performance against other methods by visually demonstrating its superior ability to accurately reproduce colors (color fidelity) and generate fine details within the colored images. The examples highlight Cobra's robustness and practical applicability by handling complex scenarios involving shadows effectively and accurately.", "section": "4.3 Comparison with baselines"}, {"figure_path": "https://arxiv.org/html/2504.12240/x8.png", "caption": "Figure 8. Interactive line art colorization using color hints, demonstrating how Cobra\u00a0 allows users to specify color adjustments in designated areas, enhancing control over the colorization process while maintaining overall stability.", "description": "Figure 8 showcases the interactive colorization capabilities of the Cobra model.  Users can directly input color adjustments to specific regions of the line art by providing color hints.  The figure demonstrates that Cobra accurately incorporates these hints, modifying the colors in the indicated areas while maintaining the overall consistency and stability of the colorization across the rest of the image. This illustrates Cobra's flexibility and its ability to support user-guided color control.", "section": "4.5 Colorization Using Color Hints"}, {"figure_path": "https://arxiv.org/html/2504.12240/x9.png", "caption": "Figure 9. Evaluation of inference time efficiency for Full Attention, Sparse Attention, and Causal Sparse Attention (with KV-Cache) across different counts of reference images.", "description": "This figure shows a comparison of inference time for three different attention mechanisms used in the Cobra model: Full Attention, Sparse Attention, and Causal Sparse Attention (with KV-Cache).  The x-axis represents the number of reference images used, and the y-axis represents the inference time per step.  The graph visually demonstrates the significant improvement in inference speed achieved by Sparse Attention and, especially, Causal Sparse Attention as the number of reference images increases.  This highlights the efficiency gains of the proposed Causal Sparse Attention method, which is crucial for handling the large number of reference images used in the Cobra model for line art colorization.", "section": "4.7 Ablation Study"}, {"figure_path": "https://arxiv.org/html/2504.12240/x10.png", "caption": "Figure 10. Limitation of Cobra\u00a0. Cobra\u00a0 preserves color identity when references share the same character (Result A), but fails when references depict different characters (Result B).", "description": "Figure 10 demonstrates the limitations of the Cobra model in terms of color identity preservation when dealing with references featuring different characters.  While Cobra successfully maintains consistent coloring (Result A) when the references show the same character, the model struggles to do so (Result B) when the references include different characters. This indicates that the model's ability to preserve color identity is strongly tied to character consistency within the reference images, and it may not generalize well to scenarios involving character variations.", "section": "4.7 Ablation Study"}, {"figure_path": "https://arxiv.org/html/2504.12240/x11.png", "caption": "Figure 11. Additional results of colorization for comic line art.", "description": "Figure 11 presents several examples of comic line art colorization using the Cobra method.  The figure shows a series of panels, each including the original black-and-white line art, a selection of reference images used for colorization, and the resulting colorized image. This visualization helps demonstrate Cobra's ability to effectively use a range of reference images to accurately and consistently colorize complex line art illustrations found in comics, handling varied characters, objects, and backgrounds.", "section": "4 Experiments"}, {"figure_path": "https://arxiv.org/html/2504.12240/x12.png", "caption": "Figure 12. Additional results of line art colorization for an anime video.", "description": "Figure 12 presents supplementary findings showcasing Cobra's capability in anime video colorization.  It displays a sequence of frames from an anime video, alongside their corresponding line art versions and the colorized outputs generated by the Cobra model.  This visually demonstrates Cobra's ability to maintain color consistency and stylistic coherence across multiple frames of a video sequence, highlighting its effectiveness in dynamic content.", "section": "4 Experiments"}, {"figure_path": "https://arxiv.org/html/2504.12240/x13.png", "caption": "Figure 13. Additional results of colorization for comic line art with shadow.", "description": "Figure 13 showcases the results of Cobra's colorization technique applied to comic book line art that includes shaded areas or shadows.  The figure presents several examples of original line art, the reference images used for colorization, and the final colored output produced by Cobra. This visually demonstrates Cobra's ability to handle the added complexity of shadows while maintaining color consistency and accuracy compared to the reference images. The examples show diverse styles of comic art and characters to illustrate the model's adaptability.", "section": "4 EXPERIMENTS"}]