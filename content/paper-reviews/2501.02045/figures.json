[{"figure_path": "https://arxiv.org/html/2501.02045/x2.png", "caption": "Figure 1: \nOverview of METAGENE-1 and applications. Wastewater samples are collected and undergo deep metagenomic sequencing to generate DNA and RNA sequences totaling over 1.5 trillion base pairs. These sequences are tokenized using byte-pair encoding (BPE) to create the pretraining dataset. The data is used to train METAGENE-1, a 7B-parameter transformer model that enables a wide range of metagenomic analysis and monitoring applications.", "description": "The figure illustrates the workflow of METAGENE-1, a metagenomic foundation model.  It begins with the collection of wastewater samples, which are then subjected to deep metagenomic sequencing to produce a massive dataset of over 1.5 trillion DNA and RNA base pairs. This raw sequence data undergoes byte-pair encoding (BPE) tokenization to create the pretraining dataset for the 7-billion parameter transformer model, METAGENE-1.  Finally, the trained METAGENE-1 model is shown to be applicable to a wide range of metagenomic analyses and monitoring tasks.", "section": "1. Introduction"}, {"figure_path": "https://arxiv.org/html/2501.02045/x3.png", "caption": "Figure 2: Overview of the metagenomic data collection and sequencing pipeline for model pretraining.\nThe process begins with the collection of wastewater (left), which contains genomic fragments from a diverse collection (e.g., tens of thousands) of constituent organisms (center). These samples are processed via high-throughput metagenomic sequencing to produce millions of paired-end reads (right), each consisting of hundreds of base pairs. The complete dataset comprises over 1.5 trillion base pairs of metagenomic sequences used for model pretraining.", "description": "Figure 2 illustrates the process of creating the metagenomic dataset used to train the METAGENE-1 model.  Starting with wastewater samples (left), which naturally contain DNA and RNA from diverse organisms (center, e.g., bacteria, viruses, human, etc.),  high-throughput sequencing is applied. This generates millions of paired-end reads (right), each several hundred base pairs long.  The combined length of these sequences in the final dataset exceeds 1.5 trillion base pairs.", "section": "3.1. Metagenomic Dataset"}, {"figure_path": "https://arxiv.org/html/2501.02045/extracted/6108967/figures/pretraining-data-snapshot.png", "caption": "Figure 3: Metagenomic composition of the METAGENE-1 pretraining dataset, estimated via Kraken 2\u00a0(Wood et\u00a0al., 2019) sequence classification, and visualized via Krona\u00a0(Ondov et\u00a0al., 2011). See Figure\u00a07 for a more-detailed view.", "description": "This figure is a visualization of the taxonomic composition of the metagenomic dataset used to pretrain the METAGENE-1 model.  The dataset was analyzed using Kraken 2 software, which identifies the taxonomic origin of short sequences (reads) by comparing them to a database of known organisms.  The resulting taxonomic assignments are displayed using the Krona software for visualization as a treemap. The visualization shows the relative abundance of different taxonomic groups present in the dataset, including bacteria, viruses, eukaryotes (mainly Homo sapiens), and unclassified sequences.  The visualization highlights the high diversity and complexity of the metagenomic data, which is typical of wastewater samples and comprises a range of organisms, making it suitable for training a general-purpose foundation model.", "section": "3.1. Metagenomic Dataset"}, {"figure_path": "https://arxiv.org/html/2501.02045/x4.png", "caption": "Figure 4: We show z\ud835\udc67zitalic_z-loss during pretraining, which aids and gives an indicator of stability.", "description": "The figure shows a graph of the z-loss during the pretraining process of the METAGENE-1 model.  The z-loss is a metric used to monitor the stability of the training process, and its behavior can indicate potential issues such as instability or divergence.  A stable training process will typically show a smooth, gradually decreasing z-loss curve. Significant fluctuations or spikes in the z-loss can signal instability, which may require intervention to prevent the training from failing.  The plot allows for visualization of the training stability of the model over time.", "section": "4. Pretraining METAGENE-1"}, {"figure_path": "https://arxiv.org/html/2501.02045/x7.png", "caption": "Figure 5: METAGENE-1 loss curves during pretraining. We show training loss (left), and validation loss on a held out metagenomic sample (right).", "description": "This figure displays the training and validation loss curves for the METAGENE-1 model during its pretraining phase. The left panel shows the training loss, which is the loss calculated on the training dataset during each iteration of training. The right panel shows the validation loss, which is the loss calculated on a separate held-out portion of the metagenomic dataset to assess the model's generalization ability.  The plots provide insights into the model's learning progress and help identify potential issues such as overfitting (where the training loss decreases while validation loss increases). The slight oscillations visible in the training curve result from the pseudo-random data shuffling employed for training efficiency.", "section": "4. Pretraining METAGENE-1"}, {"figure_path": "https://arxiv.org/html/2501.02045/x8.png", "caption": "Figure 6: Distribution of the length-normalized cross entropy loss across all datasets, given by METAGENE-1.", "description": "Figure 6 shows the distribution of length-normalized cross-entropy loss values generated by METAGENE-1 across four different datasets: metagenomics, random sequences, human genome sequences, and mouse genome sequences.  The length normalization accounts for differences in sequence length between these datasets, making the comparisons more meaningful. The figure is a histogram showing the frequency distribution of these loss values for each dataset.  This visualization helps illustrate the model's ability to distinguish between in-distribution (metagenomics) and out-of-distribution (OOD) data, which is relevant for anomaly detection tasks.", "section": "5.5. Anomaly Detection from Wastewater"}]