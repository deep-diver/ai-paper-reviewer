[{"figure_path": "https://arxiv.org/html/2502.12638/x1.png", "caption": "Figure 1: Overview of our NExT-Mol foundation model for 3D molecule generation. NExT-Mol consists of three key components: (1) MoLlama, a large LM for generating 1D molecule sequences; (2) DMT, a diffusion model to predict 3D conformers from the 1D sequences; and (3) NExT-Mol leverages transfer learning to enhance DMT\u2019s 3D prediction with MoLlama\u2019s 1D representations.", "description": "The figure illustrates the NEXT-Mol model architecture, a novel foundation model for 3D molecule generation.  It's a two-stage process. First, a large language model (LLM) called MoLlama generates a 1D representation (SELFIES string) of a molecule.  This 1D string, which guarantees 100% valid molecules, is then fed into a 3D diffusion model (DMT) to predict the 3D conformer (3D structure) of the molecule. Critically, transfer learning is employed: the knowledge gained by MoLlama in learning 1D molecular representations is transferred to improve the accuracy of the 3D conformer predictions by DMT.  The figure visually depicts these three key components (MoLlama, DMT, and the transfer learning) and their interactions, showcasing the overall process of generating 3D molecular structures.", "section": "3 3D Diffusion Meets 1D LM for 3D Molecule Generation"}, {"figure_path": "https://arxiv.org/html/2502.12638/x2.png", "caption": "Figure 2: Overview of DMT\u2019s neural architecture. (a) DMT is a diffusion model learning to denoise random Gaussian perturbations \u03f5bold-italic-\u03f5\\bm{\\epsilon}bold_italic_\u03f5 applied on the 3D coordinates of atoms. (b) DMT relies on the RMHA module to iteratively update atom representations \ud835\udc07\ud835\udc07\\mathbf{H}bold_H and pair representations \ud835\udc04\ud835\udc04\\mathbf{E}bold_E.", "description": "Figure 2 details the architecture of the Diffusion Molecular Transformer (DMT), a core component of the NEXT-Mol model.  Panel (a) illustrates the diffusion process itself: DMT takes as input a 3D molecular structure, adds random Gaussian noise to the 3D atomic coordinates, and then learns to progressively remove that noise to generate a refined structure.  Panel (b) zooms in on a single layer of the DMT neural network, showing how it uses Relational Multi-Head Self-Attention (RMHA) to simultaneously update representations of individual atoms (H) and the relationships between pairs of atoms (E). This iterative refinement process, repeated across multiple layers, allows DMT to predict accurate 3D conformations.", "section": "3D Conformer Prediction with Diffusion Molecular Transformer"}, {"figure_path": "https://arxiv.org/html/2502.12638/x3.png", "caption": "Figure 3: Transfer learning between MoLlama\u2019s 1D representations and DMT\u2019s 3D prediction. (a) A cross-modal projector bridges the gap between MoLlama and DMT. Grey H atoms have no corresponding SELFIES tokens, and are replaced by a learnable token.\n(b) Transfer learning\u2019s three training stages. Snowflake  denotes frozen parameters while flame  denotes trainable ones.", "description": "Figure 3 illustrates the transfer learning process used in NEXT-Mol to leverage 1D molecular representations from MoLlama to improve 3D conformer prediction with DMT.  Panel (a) details the cross-modal projector, which bridges MoLlama's output (SELFIES tokens) and the DMT's 3D prediction.  The projector addresses how the 1D sequence doesn't directly map to atoms in 3D structure (especially for Hydrogen atoms, indicated in grey).  Panel (b) outlines the three training stages for transfer learning: 1) DMT is initially trained in isolation, 2) the projector is warmed-up with MoLlama parameters frozen, and 3) the entire model is fine-tuned.  The use of snowflakes and flames in Panel (b) visually denotes which model components are frozen versus trainable during each stage.", "section": "3D DIFFUSION MEETS 1D LM FOR 3D MOLECULE GENERATION"}, {"figure_path": "https://arxiv.org/html/2502.12638/x14.png", "caption": "Table 6: 3D conformer prediction performance on GEOM-DRUGS\u2019s test subsets, split by scaffold frequency in the training set. 68 low-quality samples are filtered following\u00a0(Jing et\u00a0al., 2022).", "description": "This table presents the results of 3D conformer prediction experiments conducted on the GEOM-DRUGS dataset.  The key aspect is that the dataset is split into subsets based on the scaffold frequency observed within the training set.  This allows for an evaluation of how well the model generalizes to unseen molecular structures (those with infrequent scaffolds).  The results are broken down for different model configurations (DMT-B and DMT-B with MoLlama) and show metrics like AMR-R (Average Minimum RMSD Recall) and AMR-P (Average Minimum RMSD Precision)  for three subsets: unseen scaffolds, scaffolds with frequency \u22651, and scaffolds with frequency \u226510. This detailed breakdown helps to assess the model's performance on various degrees of structural novelty. The caption also notes that 68 low-quality samples were removed from the dataset before evaluation, following the methodology of a prior study (Jing et al., 2022).", "section": "3D Conformer Prediction"}, {"figure_path": "https://arxiv.org/html/2502.12638/x15.png", "caption": "(a) Case 1. L to R: GT, DMT, DMT+MoLlama.", "description": "The figure visualizes 3D conformers generated by three different methods: ground truth (GT), DMT (Diffusion Molecular Transformer), and DMT+MoLlama (DMT combined with MoLlama, a language model).  The image showcases how the addition of MoLlama enhances DMT's ability to accurately predict the 3D structure of a molecule, as demonstrated by the reduction in the root mean square deviation (RMSD) between the predicted conformer and ground truth.", "section": "3.3 MOLLAMA REPRESENTATIONS IMPROVE DMT'S 3D CONFORMER PREDICTION"}, {"figure_path": "https://arxiv.org/html/2502.12638/extracted/6212480/figures/appendix_vis/499_gt_3.png", "caption": "(b) Case 2. L to R: GT, DMT, DMT+MoLlama.", "description": "This figure visualizes the 3D conformers generated by three different methods: the ground truth conformer, the conformer predicted by the Diffusion Molecular Transformer (DMT) model alone, and the conformer predicted by the DMT model enhanced with MoLlama's 1D representations.  The goal is to show the improvement in 3D conformer prediction accuracy when incorporating MoLlama's 1D information, as reflected by the Root Mean Square Deviation (RMSD) values.", "section": "3.3 MOLLAMA REPRESENTATIONS IMPROVE DMT'S 3D CONFORMER PREDICTION"}, {"figure_path": "https://arxiv.org/html/2502.12638/extracted/6212480/figures/appendix_vis/499_dmt.png", "caption": "Figure 4: Visualization of 3D conformers. We select the predicted conformers with the least RMSD to the ground truth (GT).", "description": "Figure 4 showcases a comparison of ground truth (GT) 3D molecular conformations with those predicted by two models: DMT (Diffusion Molecular Transformer) alone and DMT enhanced by incorporating MoLlama's 1D representations.  For each molecule, the predicted conformer with the lowest Root Mean Square Deviation (RMSD) from the ground truth is selected for display. This visual comparison highlights the improvement in 3D conformer prediction accuracy achieved by integrating the 1D language model, showcasing NExT-Mol's ability to generate more accurate and realistic 3D molecular structures.", "section": "3D Conformer Prediction"}, {"figure_path": "https://arxiv.org/html/2502.12638/extracted/6212480/figures/appendix_vis/499_dmt_llama.png", "caption": "Figure 5: Effect of sampling steps on AMR\u2193\u2193\\downarrow\u2193 for 3D conformer prediction using DMT-B.", "description": "This figure shows the impact of varying the number of sampling steps on the performance of the Diffusion Molecule Transformer (DMT-B) model for 3D conformer prediction.  The x-axis represents the number of sampling steps (on a logarithmic scale), and the y-axis shows the Average Minimum Root Mean Square Deviation (AMR).  Separate lines are shown for both AMR-Recall and AMR-Precision, illustrating the precision and recall trade-offs at different sampling step counts.  The results are presented for the GEOM-DRUGS and GEOM-QM9 datasets, revealing how the model's accuracy changes as the number of sampling steps increases. The plot demonstrates the relationship between the computational cost (more sampling steps equals more computation) and the accuracy of the model.", "section": "4.4 3D MOLECULAR CONFORMER PREDICTION"}, {"figure_path": "https://arxiv.org/html/2502.12638/extracted/6212480/figures/appendix_vis/688_gt_4.png", "caption": "Figure 6: Comparison of conformer generation time on the test set of the GEOM-Drugs dataset using various methods.", "description": "Figure 6 presents a comparison of the computational time required for generating conformers using different methods on the GEOM-Drugs dataset's test set.  The graph visually represents the efficiency of various approaches in predicting molecular conformations, comparing the time taken by different methods (DMT-B, DMT-L, OMEGA, and TD w/ PG). This comparison highlights the relative computational efficiency of each method, providing insights into their practical applicability in drug discovery and material design processes, where efficient generation of conformers is crucial.", "section": "4.1 Experimental Settings"}, {"figure_path": "https://arxiv.org/html/2502.12638/extracted/6212480/figures/appendix_vis/688_dmt.png", "caption": "(a) Ground truth.", "description": "This figure visualizes 3D conformers predicted by DMT-B and DMT-B enhanced with MoLlama's 1D representations.  Each row shows the ground truth conformer, a conformer predicted by DMT-B alone, and a conformer predicted by DMT-B incorporating MoLlama's 1D information.  The root mean square deviation (RMSD) values between each prediction and the ground truth conformer are shown. The improvements in prediction accuracy after incorporating MoLlama's representations are evident in the lower RMSD values.", "section": "3D Conformer Prediction with Diffusion Molecular Transformer"}, {"figure_path": "https://arxiv.org/html/2502.12638/extracted/6212480/figures/appendix_vis/688_dmt_llama.png", "caption": "(b) DMT-B\u2019s prediction (RMSD = 0.90).", "description": "The figure shows a comparison of predicted and actual 3D conformers.  Specifically, it displays a predicted 3D molecular structure generated using the Diffusion Molecular Transformer (DMT-B) model.  The caption indicates a root mean square deviation (RMSD) value of 0.90 between the predicted and true conformer, suggesting a relatively large difference in structural geometry. The visual representation highlights the discrepancies between the predicted and actual structures of the molecule.", "section": "3D Conformer Prediction"}, {"figure_path": "https://arxiv.org/html/2502.12638/extracted/6212480/figures/appendix_vis/864_gt_5.png", "caption": "(c) DMT-B + MoLlama\u2019s prediction (RMSD = 0.05).", "description": "This figure shows the result of 3D conformer prediction using the DMT-B model enhanced with MoLlama's 1D representations.  Specifically, it displays a predicted 3D conformer with a low Root Mean Square Deviation (RMSD) of 0.05 compared to the ground truth. This illustrates the model's improved ability to generate accurate 3D molecular structures, particularly when leveraging information from the MoLlama language model.", "section": "3D Conformer Prediction with Diffusion Molecular Transformer"}, {"figure_path": "https://arxiv.org/html/2502.12638/extracted/6212480/figures/appendix_vis/864_dmt.png", "caption": "(d) Ground truth.", "description": "Figure 7 visualizes 3D conformers and the results predicted by DMT-B and DMT-B+MoLlama. For each molecule, the conformer with the lowest RMSD to the ground truth is selected. The ground truths are selected from the test set of GEOM-DRUGS with unseen scaffolds in the training set.", "section": "3D CONFORMER PREDICTION WITH DIFFUSION MOLECULAR TRANSFORMER"}, {"figure_path": "https://arxiv.org/html/2502.12638/extracted/6212480/figures/appendix_vis/864_dmt_llama.png", "caption": "(e) DMT-B\u2019s prediction (RMSD = 0.87).", "description": "This figure shows a comparison of three 3D conformers: a ground truth conformer, a conformer predicted using the DMT-B model, and a conformer predicted using DMT-B combined with MoLlama's 1D representations.  The root mean square deviation (RMSD) between the ground truth conformer and DMT-B's prediction is 0.87 angstroms. This illustrates the improvement achieved by incorporating the 1D representations from MoLlama to improve the accuracy of 3D conformer prediction. Lower RMSD values indicate better prediction accuracy.", "section": "3D CONFORMER PREDICTION WITH DIFFUSION MOLECULAR TRANSFORMER"}, {"figure_path": "https://arxiv.org/html/2502.12638/extracted/6212480/figures/appendix_vis/892_gt.png", "caption": "(f) DMT-B + MoLlama\u2019s prediction (RMSD = 0.06).", "description": "This figure visualizes the 3D conformer prediction results for a molecule.  The image shows three 3D conformers: (a) the ground truth conformer obtained from the GEOM-DRUGS dataset, (b) the conformer predicted using only the DMT-B model, and (c) the conformer predicted using both the DMT-B and MoLlama models.  The Root Mean Square Deviation (RMSD) values, a measure of structural similarity between the conformers, are provided to quantify the differences between the predicted conformers and the ground truth.  Lower RMSD values indicate better prediction accuracy.", "section": "3D Conformer Prediction with Diffusion Molecular Transformer"}, {"figure_path": "https://arxiv.org/html/2502.12638/extracted/6212480/figures/appendix_vis/892_dmt.png", "caption": "(g) Ground truth.", "description": "This figure visualizes a 3D conformer predicted by DMT-B, with and without using MoLlama's 1D representations, alongside its ground truth conformer.  The root-mean-square deviation (RMSD) values are provided to quantify the difference between predicted and ground truth conformers.  The image showcases the model's capability to generate accurate and valid conformers when incorporating MoLlama's representations.", "section": "3D CONFORMER PREDICTION WITH DIFFUSION MOLECULAR TRANSFORMER"}, {"figure_path": "https://arxiv.org/html/2502.12638/extracted/6212480/figures/appendix_vis/892_dmt_llama.png", "caption": "(h) DMT-B\u2019s prediction (RMSD = 0.84).", "description": "This figure shows a comparison of three different 3D conformers for a molecule. The first conformer is the ground truth, which represents the actual 3D structure of the molecule. The second conformer was generated by the Diffusion Molecular Transformer (DMT-B) model without the assistance of the Molecular Llama (MoLlama) Language Model. The third conformer was generated by DMT-B with the assistance of MoLlama. The Root Mean Square Deviation (RMSD) values are provided for each conformer to quantify the differences between the predicted conformers and the ground truth. A lower RMSD value indicates a better prediction. In this instance, the conformer predicted by DMT-B in conjunction with MoLlama shows a significantly lower RMSD value than the conformer predicted by DMT-B alone, highlighting the effectiveness of incorporating the MoLlama Language Model to enhance the prediction accuracy of the 3D conformers.", "section": "3D Conformer Prediction with Diffusion Molecular Transformer"}, {"figure_path": "https://arxiv.org/html/2502.12638/extracted/6212480/figures/random_samples_DRUGS.png", "caption": "(i) DMT-B + MoLlama\u2019s prediction (RMSD = 0.07).", "description": "This figure visualizes a 3D conformer predicted by the model DMT-B enhanced with MoLlama's 1D representations. It shows the predicted conformer's spatial arrangement of atoms, demonstrating how incorporating MoLlama's 1D representation improves the model's ability to accurately predict 3D conformers. The RMSD (Root Mean Square Deviation) value of 0.07 indicates a relatively good match between the predicted and ground truth conformers, highlighting the effectiveness of the model.", "section": "3D Conformer Prediction with Diffusion Molecular Transformer"}, {"figure_path": "https://arxiv.org/html/2502.12638/extracted/6212480/figures/random_samples_QM9.png", "caption": "(j) Ground truth.", "description": "Figure 7 visualizes 3D conformers and the prediction results by DMT-B and DMT-B+MoLlama. For each model, the conformer with the least RMSD to the ground truth conformer is selected. The conformers in the figure are selected from the test set of GEOM-DRUGS with unseen scaffolds in the training set.", "section": "3D CONFORMER PREDICTION WITH DIFFUSION MOLECULAR TRANSFORMER"}, {"figure_path": "https://arxiv.org/html/2502.12638/x16.png", "caption": "(k) DMT-B\u2019s prediction (RMSD = 0.86).", "description": "This figure is a visualization of 3D conformers. It shows the ground truth conformer, the conformer predicted by DMT-B (a diffusion molecular transformer model), and the conformer predicted by DMT-B+MoLlama (DMT-B combined with a molecular language model, MoLlama).  The image displays the predicted conformers with the lowest RMSD (root mean square deviation) values compared to the ground truth conformer.  The goal is to demonstrate the improved accuracy of 3D conformer prediction when MoLlama is integrated with DMT-B. The RMSD values are displayed for each prediction, quantifying the difference between the predicted and ground truth conformers.", "section": "3D Conformer Prediction with Diffusion Molecular Transformer"}]