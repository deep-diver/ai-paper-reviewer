---
title: "Token Assorted: Mixing Latent and Text Tokens for Improved Language Model Reasoning"
summary: "Boosting language model reasoning:  A novel hybrid approach using latent tokens drastically shortens reasoning traces, improving model performance and efficiency."
categories: ["AI Generated", "ğŸ¤— Daily Papers"]
tags: ["Natural Language Processing", "Large Language Models", "ğŸ¢ Meta AI",]
showSummary: true
date: 2025-02-05
draft: false
---

<br>

{{< keywordList >}}
{{< keyword icon="fingerprint" >}} 2502.03275 {{< /keyword >}}
{{< keyword icon="writer" >}} DiJia Su et el. {{< /keyword >}}
 
{{< keyword >}} ğŸ¤— 2025-02-06 {{< /keyword >}}
 
{{< /keywordList >}}

{{< button href="https://arxiv.org/abs/2502.03275" target="_self" >}}
â†— arXiv
{{< /button >}}
{{< button href="https://huggingface.co/papers/2502.03275" target="_self" >}}
â†— Hugging Face
{{< /button >}}



<audio controls>
    <source src="https://ai-paper-reviewer.com/2502.03275/podcast.wav" type="audio/wav">
    Your browser does not support the audio element.
</audio>


### TL;DR


{{< lead >}}

Current large language models (LLMs) excel at reasoning when provided with step-by-step explanations (chain-of-thought prompting). However, this method leads to lengthy inputs, increasing computational costs.  This paper tackles this issue by focusing on the efficiency problem of chain-of-thought prompting. The core problem is that using many words for explanation consumes lots of computational resources and increases response time. 

This research introduces a hybrid approach that uses latent discrete tokens (generated by VQ-VAE) to partially represent the initial reasoning steps.  This significantly reduces the input length. The researchers trained the model using a random mixing strategy of latent and text tokens, adapting quickly to new tokens and achieving significant performance gains in various benchmarks (Math, GSM8K, and a fresh Gaokao Math dataset). The experiments show that the proposed method not only improved performance but also significantly reduced reasoning trace length (on average, 17%).

{{< /lead >}}


#### Key Takeaways

{{< alert "star" >}}
{{< typeit speed=10 lifeLike=true >}} A hybrid representation of reasoning processes using latent tokens significantly reduces reasoning trace length, thus improving computational efficiency. {{< /typeit >}}
{{< /alert >}}

{{< alert "star" >}}
{{< typeit speed=10 startDelay=1000 lifeLike=true >}} The proposed training procedure, which mixes latent and text tokens, facilitates effective learning with unseen latent tokens. {{< /typeit >}}
{{< /alert >}}

{{< alert "star" >}}
{{< typeit speed=10 startDelay=2000 lifeLike=true >}} Consistent performance improvements over baseline methods are demonstrated across various benchmarks, including mathematical and logical reasoning tasks. {{< /typeit >}}
{{< /alert >}}

#### Why does it matter?
This paper is crucial for researchers working on **large language models (LLMs)** and **reasoning**.  It addresses the computational cost of chain-of-thought prompting by introducing a novel method to significantly shorten reasoning traces, thus enhancing LLM efficiency and performance.  The proposed technique of using latent tokens opens **new avenues for research on efficient and effective LLM training** and offers a potential solution to improve the overall efficiency of using LLMs for various reasoning and planning tasks. This is highly relevant given the increasing emphasis on reducing the computational footprint of LLMs.

------
#### Visual Insights



![](https://arxiv.org/html/2502.03275/x1.png)

> ğŸ”¼ This figure illustrates the method of compressing reasoning traces in the paper by replacing sequences of text tokens with latent tokens.  Specifically, it shows an example where 32 consecutive chain-of-thought (CoT) tokens are replaced by two latent tokens.  The replacement starts from the left and proceeds to the right up to a predefined point;  after that point, the remaining CoT tokens retain their original form. This technique is used to shorten the length of reasoning traces and reduce computational costs while preserving the crucial reasoning information. The chunk size (L) is set to 16, and the compression rate (r) is also 16, indicating that each chunk of 16 tokens is replaced by one latent token.
> <details>
> <summary>read the caption</summary>
> Figure 3.1: An example illustrating our replacement strategy. With chunk size L=16ğ¿16L=16italic_L = 16 and compression rate r=16ğ‘Ÿ16r=16italic_r = 16, we encode 32 textual CoT tokens into 2 discrete latent tokens from left to right. The other CoT tokens will remain in their original forms.
> </details>





{{< table-caption >}}
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T1.3.3">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T1.3.3.4.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T1.3.3.4.1.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="S4.T1.3.3.4.1.1.1">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S4.T1.3.3.4.1.2"><span class="ltx_text ltx_font_bold" id="S4.T1.3.3.4.1.2.1">Keys-Finding Maze</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S4.T1.3.3.4.1.3"><span class="ltx_text ltx_font_bold" id="S4.T1.3.3.4.1.3.1">ProntoQA</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S4.T1.3.3.4.1.4"><span class="ltx_text ltx_font_bold" id="S4.T1.3.3.4.1.4.1">ProsQA</span></th>
</tr>
<tr class="ltx_tr" id="S4.T1.3.3.5.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.3.3.5.2.1">1-Feasible-10 (%)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.3.3.5.2.2">Num. Tokens</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.3.3.5.2.3">Accuracy</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.3.3.5.2.4">Num. Tokens</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.3.3.5.2.5">Accuracy</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.3.3.5.2.6">Num. Tokens</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.3.3.6.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T1.3.3.6.1.1">Sol-Only</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.3.6.1.2">3</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.3.6.1.3">645</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.3.6.1.4">93.8</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.3.6.1.5">3.0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.3.6.1.6">76.7</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.3.6.1.7">8.2</td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.3.7.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.3.3.7.2.1">CoT</th>
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.7.2.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.3.3.7.2.2.1">43</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.7.2.3">1312.0</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.7.2.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.3.3.7.2.4.1">98.8</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.7.2.5">92.5</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.7.2.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.3.3.7.2.6.1">77.5</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.7.2.7">49.4</td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S4.T1.3.3.3.4"><span class="ltx_text ltx_font_bold" id="S4.T1.3.3.3.4.1">Latent (ours)</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.1">62.8 <span class="ltx_text" id="S4.T1.1.1.1.1.1.1" style="color:#008000;">(<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T1.1.1.1.1.1.1.m1.1"><semantics id="S4.T1.1.1.1.1.1.1.m1.1a"><mo id="S4.T1.1.1.1.1.1.1.m1.1.1" mathcolor="#008000" stretchy="false" xref="S4.T1.1.1.1.1.1.1.m1.1.1.cmml">â†‘</mo><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.1.1.1.m1.1b"><ci id="S4.T1.1.1.1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.1.1.1.m1.1.1">â†‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.1.1.1.1.1.1.m1.1d">â†‘</annotation></semantics></math> +19.8)</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.3.3.3.5">374.6</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.2.2.2.2"><span class="ltx_text ltx_font_bold" id="S4.T1.2.2.2.2.1">100 <span class="ltx_text" id="S4.T1.2.2.2.2.1.1" style="color:#008000;">(<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T1.2.2.2.2.1.1.m1.1"><semantics id="S4.T1.2.2.2.2.1.1.m1.1a"><mo id="S4.T1.2.2.2.2.1.1.m1.1.1" mathcolor="#008000" stretchy="false" xref="S4.T1.2.2.2.2.1.1.m1.1.1.cmml">â†‘</mo><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.2.2.1.1.m1.1b"><ci id="S4.T1.2.2.2.2.1.1.m1.1.1.cmml" xref="S4.T1.2.2.2.2.1.1.m1.1.1">â†‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.2.2.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.2.2.2.2.1.1.m1.1d">â†‘</annotation></semantics></math> +1.2)</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.3.3.3.6">7.7</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.3.3.3.3"><span class="ltx_text ltx_font_bold" id="S4.T1.3.3.3.3.1">96.2 <span class="ltx_text" id="S4.T1.3.3.3.3.1.1" style="color:#008000;">(<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T1.3.3.3.3.1.1.m1.1"><semantics id="S4.T1.3.3.3.3.1.1.m1.1a"><mo id="S4.T1.3.3.3.3.1.1.m1.1.1" mathcolor="#008000" stretchy="false" xref="S4.T1.3.3.3.3.1.1.m1.1.1.cmml">â†‘</mo><annotation-xml encoding="MathML-Content" id="S4.T1.3.3.3.3.1.1.m1.1b"><ci id="S4.T1.3.3.3.3.1.1.m1.1.1.cmml" xref="S4.T1.3.3.3.3.1.1.m1.1.1">â†‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.3.3.3.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.3.3.3.3.1.1.m1.1d">â†‘</annotation></semantics></math> +18.7)</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.3.3.3.7">10.9</td>
</tr>
</tbody>
</table>{{< /table-caption >}}

> ğŸ”¼ Table 4.1 presents a comparison of different methods for solving three reasoning tasks: Keys-Finding Maze, ProntoQA, and ProsQA.  The results demonstrate that the proposed 'latent approach' significantly outperforms existing methods (Sol-Only, CoT, iCoT) in terms of accuracy across all three tasks.  Importantly, the table also highlights the efficiency gains of the latent approach.  It shows a substantial reduction in the number of tokens required for generating solutions compared to the chain-of-thought (CoT) baseline, while achieving accuracy comparable to or exceeding the Sol-Only approach which generates the shortest traces.
> <details>
> <summary>read the caption</summary>
> Table 4.1: Our latent approach surpasses the other baselines on Keys-Finding Maze, ProntoQA and ProsQA with a large margin . We use top-kğ‘˜kitalic_k (k=10ğ‘˜10k=10italic_k = 10) decoding for Keys-Finding Maze and greedy decoding for ProntoQA and ProsQA. In terms of token efficiency, our latent approach also generates much shorter reasoning traces than the CoT baseline, closely tracking or even outperforming the Sol-Only approach. Bold: best results. Underline: second best results. (â†‘â†‘\uparrowâ†‘ +Performance gain compared with the second best result.)
> </details>





### In-depth insights


#### Latent Reasoning
Latent reasoning, in the context of large language models (LLMs), represents **a significant advancement** in improving reasoning capabilities.  Instead of relying solely on explicit textual reasoning steps, which can be computationally expensive and lengthy, latent reasoning aims to **implicitly capture the core essence of reasoning** within a compact, compressed representation. This is often achieved through techniques like vector quantization (VQ-VAE), where intermediate reasoning steps are encoded into discrete latent tokens.  **The key advantage** is that these latent representations dramatically reduce the length of reasoning traces processed by the LLM, leading to improved efficiency and potentially better performance on complex reasoning tasks.  However, effective utilization of latent reasoning requires careful consideration of several factors.  Successful implementation necessitates a robust encoding mechanism that can **accurately capture the nuances of the reasoning process** and a decoding method that allows the LLM to effectively utilize these latent tokens. Furthermore, training methods must be carefully designed to allow the model to adapt effectively to the presence of unseen latent tokens in the fine-tuning stage, and to balance the benefits of compressed representation against potential information loss.

#### VQ-VAE Encoding
The concept of 'VQ-VAE Encoding' in the context of a research paper likely refers to the use of a Vector Quantized Variational Autoencoder (VQ-VAE) to generate a compressed, discrete latent representation of input data.  **This technique is particularly relevant for processing long sequences, such as those found in chain-of-thought (CoT) reasoning traces** where many words contribute to textual coherence rather than core reasoning information.  The VQ-VAE learns to map sequences of text tokens (the CoT trace) into a lower-dimensional space represented by a discrete set of 'latent tokens'.  **This compression significantly reduces computational cost and memory usage.**  A crucial aspect is the use of a codebook, which acts as a lookup table, converting these latent vectors back to meaningful representations.  The effectiveness of this approach depends on the VQ-VAE's ability to capture the essence of the reasoning steps without losing crucial information and the subsequent LLM's capacity to learn and effectively utilize this compressed representation during reasoning tasks.  **The success likely hinges on both the design and training of the VQ-VAE as well as the method used to integrate these latent tokens with the remaining parts of the CoT trace** during the final model training phase. Therefore, a thorough discussion of architecture, training strategies, and quantitative results evaluating the trade-off between compression and reasoning performance would be expected in a detailed exploration of 'VQ-VAE Encoding'.

#### Hybrid Training
A hypothetical "Hybrid Training" section in a research paper on language models would likely explore methods combining different training paradigms to leverage their respective strengths.  **One approach could involve pretraining a model on a massive text corpus using standard techniques, followed by finetuning on a smaller, higher-quality dataset designed for specific reasoning tasks.** This approach leverages the general knowledge and language proficiency from pretraining, enhancing the model's ability to reason effectively on more specific tasks during finetuning.  **Another strategy might involve integrating reinforcement learning (RL) with supervised learning.**  Initially, supervised learning would establish a baseline performance; RL would then refine the modelâ€™s reasoning skills by providing rewards for correct answers and penalties for incorrect ones. This could address the limitations of pure supervised learning by allowing the model to learn from experience and adapt to nuanced problem-solving scenarios. **A particularly innovative approach could combine symbolic reasoning methods with neural networks.** This could involve incorporating explicit rules and logical structures into the model's architecture, complementing the network's ability to learn complex patterns from data.  The potential benefits of such an approach are considerable, offering improved robustness and explainability, while also potentially enabling the model to handle more complex and abstract reasoning problems.  The challenges would focus on effective integration of these disparate methods and balancing the benefits of each approach.  Careful evaluation would be needed to determine the efficacy and efficiency of hybrid approaches compared to traditional methods.

#### Benchmark Results
A dedicated 'Benchmark Results' section in a research paper would ideally present a comprehensive evaluation of the proposed method against existing state-of-the-art techniques.  This would involve selecting relevant and diverse benchmarks, clearly describing the evaluation metrics used, and presenting the results in a clear and easily interpretable format, such as tables and charts.  **Crucially, the analysis should go beyond simply reporting raw numbers.**  A robust analysis would delve into the strengths and weaknesses of the proposed method relative to the baselines, exploring possible reasons for superior or inferior performance on specific benchmarks.  For instance, if the new method excels on certain tasks but underperforms on others, the reasons for these discrepancies would be investigated and discussed, possibly pointing to areas for future improvement. **Statistical significance testing** would provide strong evidence supporting the claims of improvement.  Further, discussing limitations of the benchmarks themselves and potential biases inherent in the dataset is essential to promote a balanced and credible interpretation of the results. Finally, a detailed discussion of the efficiency and resource requirements of the new method, compared to existing methods, would provide a holistic perspective.

#### Token Efficiency
The concept of **token efficiency** in large language models (LLMs) is crucial for optimizing both computational resources and inference speed.  The paper explores this by introducing a hybrid representation of reasoning processes, leveraging latent discrete tokens alongside traditional text tokens.  This approach significantly reduces the length of reasoning traces, leading to improved **token efficiency**. The reduction in trace length is achieved by abstracting away initial reasoning steps using a vector-quantized variational autoencoder (VQ-VAE), thereby compressing the information into fewer tokens.  The effectiveness of this method is demonstrated across various benchmarks, showing consistent improvements in reasoning tasks while using significantly shorter input sequences.  The method also incorporates a randomized replacement strategy during training, enabling fast adaptation to new latent tokens, further enhancing **token efficiency** and overall performance.  **Reduced computational cost and faster inference** are the direct benefits of this improved token efficiency, making the approach particularly valuable for resource-constrained environments and applications requiring real-time responses.


### More visual insights

<details>
<summary>More on figures
</summary>


![](https://arxiv.org/html/2502.03275/x2.png)

> ğŸ”¼ The figure illustrates the Vector Quantized Variational Autoencoder (VQ-VAE) used to generate latent tokens for compressing reasoning traces. The VQ-VAE consists of an encoder (f_enc), a codebook, a quantizer (q), and a decoder (f_dec). The encoder maps sequences of text tokens representing reasoning steps into continuous embedding vectors. These vectors are then quantized to the nearest codebook entry using the quantizer, yielding a discrete latent token representing the original sequence. The decoder maps these latent tokens back to text tokens. This process converts the original sequence of text tokens into a compressed sequence of discrete latent tokens, which can be used to shorten reasoning traces and improve efficiency. The VQ-VAE is trained on the whole input sequence X to enhance the quality of latent abstractions, although it only operates on the reasoning steps during inference, effectively abstracting away the less informative initial steps of the reasoning process.
> <details>
> <summary>read the caption</summary>
> Figure 3.2: A graphical illustration of our VQ-VAE. fencsubscriptğ‘“enc{f_{\text{enc}}}italic_f start_POSTSUBSCRIPT enc end_POSTSUBSCRIPT encodes the text tokens into latent embeddings, which are quantized by checking the nearest neighbors in the codebook. fdecsubscriptğ‘“dec{f_{\text{dec}}}italic_f start_POSTSUBSCRIPT dec end_POSTSUBSCRIPT decodes those quantized embeddings back to text tokens. When applying the VQ-VAE to compress the text tokens, the discrete latent tokens Zğ‘Zitalic_Z are essentially the index of corresponding embeddings in the codebook.
> </details>



![](https://arxiv.org/html/2502.03275/extracted/6181144/plots/entry_1.png)

> ğŸ”¼ This figure shows a comparison of the average attention weights across input prompt tokens between the proposed latent model and the baseline CoT model for the question: What is the positive difference between 120% of 30 and 130% of 20?.  The latent model demonstrates a stronger focus on numerical values and mathematical operation tokens, highlighting its improved ability to process mathematical problems.
> <details>
> <summary>read the caption</summary>
> (a) Prompt: What is the positive difference between $120%$ of 30 and $130%$ of 20?
> </details>



![](https://arxiv.org/html/2502.03275/extracted/6181144/plots/entry_7746.png)

> ğŸ”¼ This figure shows the attention weights visualization for the second question in the prompt: Mark has $50 in his bank account; he earns $10 per day at his work. If he wants to buy a bike that costs $300, how many days does Mark have to save his money?. The visualization compares the attention weights of the model using the proposed latent approach against the baseline CoT model. It demonstrates that the latent approach focuses more attention on the numbers (50, 10, 300) and words representing mathematical operations, indicating a better understanding of the problem's numerical aspects.
> <details>
> <summary>read the caption</summary>
> (b) Prompt: Mark has $50 in his bank account. He earns $10 per day at his work. If he wants to buy a bike that costs $300, how many days does Mark have to save his money?
> </details>



![](https://arxiv.org/html/2502.03275/extracted/6181144/plots/maze_env.png)

> ğŸ”¼ Figure 4.1 presents a comparison of attention weights between the proposed latent approach and the baseline chain-of-thought (CoT) method.  The visualization shows the average attention weights assigned to input tokens during the generation of responses for two mathematical reasoning problems.  The latent model is shown to have significantly higher attention weights on numbers and operation-related tokens compared to the CoT model, indicating a stronger focus on core numerical computation in the latent approach.
> <details>
> <summary>read the caption</summary>
> Figure 4.1: Comparing with the CoT model, our latent approach have high attention weights on numbers and text tokens representing mathematical operations.
> </details>



![](https://arxiv.org/html/2502.03275/extracted/6181144/plots/maze_traj1.png)

> ğŸ”¼ This figure shows a visual representation of the Keys-Finding Maze environment used in the experiments. It's a grid-based maze where an agent needs to navigate to a target location by collecting keys to open color-coded doors. The maze is composed of multiple interconnected rooms, making it more complex than a simple path-finding problem.
> <details>
> <summary>read the caption</summary>
> Figure A.1: An example of the keys-finding maze environment.
> </details>



![](https://arxiv.org/html/2502.03275/extracted/6181144/plots/maze_traj2.png)

> ğŸ”¼ This figure shows the first phase of a multi-step process in a Keys-Finding Maze environment.  The agent (black circle) is in a maze and must navigate to a goal location (gold diamond).  To get there, they must collect keys of different colors (red, green, blue) that correspond to similarly colored doors, one key at a time. This first phase depicts the agent's initial state and the location of the goal, keys and doors.
> <details>
> <summary>read the caption</summary>
> (a) Phase 1
> </details>



![](https://arxiv.org/html/2502.03275/extracted/6181144/plots/maze_traj3.png)

> ğŸ”¼ This phase of the Keys-Finding Maze shows the agent, after obtaining the blue key in Phase 1, proceeding to open the blue door to access the red key.  The agent's next step will involve using the red key.
> <details>
> <summary>read the caption</summary>
> (b) Phase 2
> </details>



![](https://arxiv.org/html/2502.03275/extracted/6181144/plots/maze_traj4.png)

> ğŸ”¼ This figure shows the third phase of an agent's optimal trajectory in a keys-finding maze. The agent has already acquired the blue key, opened the blue door, and obtained the red key. In this phase, the agent is moving towards the red door to use the red key to open it.
> <details>
> <summary>read the caption</summary>
> (c) Phase 3
> </details>



</details>




<details>
<summary>More on tables
</summary>


{{< table-caption >}}
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A1.T1.2">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A1.T1.2.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A1.T1.2.1.1.1"><span class="ltx_text ltx_font_bold" id="A1.T1.2.1.1.1.1">Parameter</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T1.2.1.1.2"><span class="ltx_text ltx_font_bold" id="A1.T1.2.1.1.2.1">Value</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T1.2.2.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T1.2.2.1.1">Number of Layers (Transformer Blocks)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T1.2.2.1.2">12</td>
</tr>
<tr class="ltx_tr" id="A1.T1.2.3.2">
<td class="ltx_td ltx_align_left" id="A1.T1.2.3.2.1">Hidden Size (Embedding Size)</td>
<td class="ltx_td ltx_align_center" id="A1.T1.2.3.2.2">768</td>
</tr>
<tr class="ltx_tr" id="A1.T1.2.4.3">
<td class="ltx_td ltx_align_left" id="A1.T1.2.4.3.1">Number of Attention Heads</td>
<td class="ltx_td ltx_align_center" id="A1.T1.2.4.3.2">12</td>
</tr>
<tr class="ltx_tr" id="A1.T1.2.5.4">
<td class="ltx_td ltx_align_left" id="A1.T1.2.5.4.1">Vocabulary Size</td>
<td class="ltx_td ltx_align_center" id="A1.T1.2.5.4.2">50,257</td>
</tr>
<tr class="ltx_tr" id="A1.T1.2.6.5">
<td class="ltx_td ltx_align_left ltx_border_bb" id="A1.T1.2.6.5.1">Total Number of Parameters</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T1.2.6.5.2">117 million</td>
</tr>
</tbody>
</table>{{< /table-caption >}}
> ğŸ”¼ Table 4.2 presents a comprehensive evaluation of the proposed 'latent approach' on various mathematical reasoning benchmarks.  Models were fine-tuned using the MetaMathQA dataset.  The results are compared against several baselines: Sol-Only (trained only on solutions), CoT (trained with complete chain-of-thought), iCoT (iterative chain-of-thought elimination), and Pause Token (uses pause tokens).  The table highlights performance gains of the latent approach compared to the second-best baseline for each benchmark, categorized by in-domain (Math and GSM8K, which were used to create the MetaMathQA training data) and out-of-domain datasets.  Bold text indicates the best result, underlined text the second-best, and the arrows indicate the performance improvements.
> <details>
> <summary>read the caption</summary>
> Table 4.2:  Our latent approach outperforms the baselines on various types of mathematical reasoning benchmarks. The models are fine-tuned on the MetaMathQAÂ (Yu etÂ al., 2023) dataset. The Math and GSM8K are in-domain datasets since they are used to generate MetaMathQA, while the others are out-of-domain. Bold: best results. Underscore: second best results. â†‘â†‘\uparrowâ†‘ +: â€…Performance gain compared with the second best result.
> </details>

{{< table-caption >}}
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A2.T1.45">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A2.T1.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="A2.T1.1.1.1"><math alttext="X=P\oplus C\oplus S" class="ltx_Math" display="inline" id="A2.T1.1.1.1.m1.1"><semantics id="A2.T1.1.1.1.m1.1a"><mrow id="A2.T1.1.1.1.m1.1.1" xref="A2.T1.1.1.1.m1.1.1.cmml"><mi id="A2.T1.1.1.1.m1.1.1.2" xref="A2.T1.1.1.1.m1.1.1.2.cmml">X</mi><mo id="A2.T1.1.1.1.m1.1.1.1" xref="A2.T1.1.1.1.m1.1.1.1.cmml">=</mo><mrow id="A2.T1.1.1.1.m1.1.1.3" xref="A2.T1.1.1.1.m1.1.1.3.cmml"><mi id="A2.T1.1.1.1.m1.1.1.3.2" xref="A2.T1.1.1.1.m1.1.1.3.2.cmml">P</mi><mo id="A2.T1.1.1.1.m1.1.1.3.1" xref="A2.T1.1.1.1.m1.1.1.3.1.cmml">âŠ•</mo><mi id="A2.T1.1.1.1.m1.1.1.3.3" xref="A2.T1.1.1.1.m1.1.1.3.3.cmml">C</mi><mo id="A2.T1.1.1.1.m1.1.1.3.1a" xref="A2.T1.1.1.1.m1.1.1.3.1.cmml">âŠ•</mo><mi id="A2.T1.1.1.1.m1.1.1.3.4" xref="A2.T1.1.1.1.m1.1.1.3.4.cmml">S</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.T1.1.1.1.m1.1b"><apply id="A2.T1.1.1.1.m1.1.1.cmml" xref="A2.T1.1.1.1.m1.1.1"><eq id="A2.T1.1.1.1.m1.1.1.1.cmml" xref="A2.T1.1.1.1.m1.1.1.1"></eq><ci id="A2.T1.1.1.1.m1.1.1.2.cmml" xref="A2.T1.1.1.1.m1.1.1.2">ğ‘‹</ci><apply id="A2.T1.1.1.1.m1.1.1.3.cmml" xref="A2.T1.1.1.1.m1.1.1.3"><csymbol cd="latexml" id="A2.T1.1.1.1.m1.1.1.3.1.cmml" xref="A2.T1.1.1.1.m1.1.1.3.1">direct-sum</csymbol><ci id="A2.T1.1.1.1.m1.1.1.3.2.cmml" xref="A2.T1.1.1.1.m1.1.1.3.2">ğ‘ƒ</ci><ci id="A2.T1.1.1.1.m1.1.1.3.3.cmml" xref="A2.T1.1.1.1.m1.1.1.3.3">ğ¶</ci><ci id="A2.T1.1.1.1.m1.1.1.3.4.cmml" xref="A2.T1.1.1.1.m1.1.1.3.4">ğ‘†</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.1.1.1.m1.1c">X=P\oplus C\oplus S</annotation><annotation encoding="application/x-llamapun" id="A2.T1.1.1.1.m1.1d">italic_X = italic_P âŠ• italic_C âŠ• italic_S</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left ltx_border_tt" id="A2.T1.2.2.2">input text sample where <math alttext="\oplus" class="ltx_Math" display="inline" id="A2.T1.2.2.2.m1.1"><semantics id="A2.T1.2.2.2.m1.1a"><mo id="A2.T1.2.2.2.m1.1.1" xref="A2.T1.2.2.2.m1.1.1.cmml">âŠ•</mo><annotation-xml encoding="MathML-Content" id="A2.T1.2.2.2.m1.1b"><csymbol cd="latexml" id="A2.T1.2.2.2.m1.1.1.cmml" xref="A2.T1.2.2.2.m1.1.1">direct-sum</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.2.2.2.m1.1c">\oplus</annotation><annotation encoding="application/x-llamapun" id="A2.T1.2.2.2.m1.1d">âŠ•</annotation></semantics></math> means concatenation</td>
</tr>
<tr class="ltx_tr" id="A2.T1.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T1.3.3.1"><math alttext="P" class="ltx_Math" display="inline" id="A2.T1.3.3.1.m1.1"><semantics id="A2.T1.3.3.1.m1.1a"><mi id="A2.T1.3.3.1.m1.1.1" xref="A2.T1.3.3.1.m1.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="A2.T1.3.3.1.m1.1b"><ci id="A2.T1.3.3.1.m1.1.1.cmml" xref="A2.T1.3.3.1.m1.1.1">ğ‘ƒ</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.3.3.1.m1.1c">P</annotation><annotation encoding="application/x-llamapun" id="A2.T1.3.3.1.m1.1d">italic_P</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="A2.T1.4.4.2">prompt of length <math alttext="t_{p}" class="ltx_Math" display="inline" id="A2.T1.4.4.2.m1.1"><semantics id="A2.T1.4.4.2.m1.1a"><msub id="A2.T1.4.4.2.m1.1.1" xref="A2.T1.4.4.2.m1.1.1.cmml"><mi id="A2.T1.4.4.2.m1.1.1.2" xref="A2.T1.4.4.2.m1.1.1.2.cmml">t</mi><mi id="A2.T1.4.4.2.m1.1.1.3" xref="A2.T1.4.4.2.m1.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="A2.T1.4.4.2.m1.1b"><apply id="A2.T1.4.4.2.m1.1.1.cmml" xref="A2.T1.4.4.2.m1.1.1"><csymbol cd="ambiguous" id="A2.T1.4.4.2.m1.1.1.1.cmml" xref="A2.T1.4.4.2.m1.1.1">subscript</csymbol><ci id="A2.T1.4.4.2.m1.1.1.2.cmml" xref="A2.T1.4.4.2.m1.1.1.2">ğ‘¡</ci><ci id="A2.T1.4.4.2.m1.1.1.3.cmml" xref="A2.T1.4.4.2.m1.1.1.3">ğ‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.4.4.2.m1.1c">t_{p}</annotation><annotation encoding="application/x-llamapun" id="A2.T1.4.4.2.m1.1d">italic_t start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="A2.T1.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T1.5.5.1"><math alttext="p_{i}" class="ltx_Math" display="inline" id="A2.T1.5.5.1.m1.1"><semantics id="A2.T1.5.5.1.m1.1a"><msub id="A2.T1.5.5.1.m1.1.1" xref="A2.T1.5.5.1.m1.1.1.cmml"><mi id="A2.T1.5.5.1.m1.1.1.2" xref="A2.T1.5.5.1.m1.1.1.2.cmml">p</mi><mi id="A2.T1.5.5.1.m1.1.1.3" xref="A2.T1.5.5.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A2.T1.5.5.1.m1.1b"><apply id="A2.T1.5.5.1.m1.1.1.cmml" xref="A2.T1.5.5.1.m1.1.1"><csymbol cd="ambiguous" id="A2.T1.5.5.1.m1.1.1.1.cmml" xref="A2.T1.5.5.1.m1.1.1">subscript</csymbol><ci id="A2.T1.5.5.1.m1.1.1.2.cmml" xref="A2.T1.5.5.1.m1.1.1.2">ğ‘</ci><ci id="A2.T1.5.5.1.m1.1.1.3.cmml" xref="A2.T1.5.5.1.m1.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.5.5.1.m1.1c">p_{i}</annotation><annotation encoding="application/x-llamapun" id="A2.T1.5.5.1.m1.1d">italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="A2.T1.6.6.2">the <math alttext="i" class="ltx_Math" display="inline" id="A2.T1.6.6.2.m1.1"><semantics id="A2.T1.6.6.2.m1.1a"><mi id="A2.T1.6.6.2.m1.1.1" xref="A2.T1.6.6.2.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A2.T1.6.6.2.m1.1b"><ci id="A2.T1.6.6.2.m1.1.1.cmml" xref="A2.T1.6.6.2.m1.1.1">ğ‘–</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.6.6.2.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="A2.T1.6.6.2.m1.1d">italic_i</annotation></semantics></math>-th token of prompt (in text)</td>
</tr>
<tr class="ltx_tr" id="A2.T1.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T1.7.7.1"><math alttext="C" class="ltx_Math" display="inline" id="A2.T1.7.7.1.m1.1"><semantics id="A2.T1.7.7.1.m1.1a"><mi id="A2.T1.7.7.1.m1.1.1" xref="A2.T1.7.7.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="A2.T1.7.7.1.m1.1b"><ci id="A2.T1.7.7.1.m1.1.1.cmml" xref="A2.T1.7.7.1.m1.1.1">ğ¶</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.7.7.1.m1.1c">C</annotation><annotation encoding="application/x-llamapun" id="A2.T1.7.7.1.m1.1d">italic_C</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="A2.T1.8.8.2">reasoning trace of length <math alttext="t_{c}" class="ltx_Math" display="inline" id="A2.T1.8.8.2.m1.1"><semantics id="A2.T1.8.8.2.m1.1a"><msub id="A2.T1.8.8.2.m1.1.1" xref="A2.T1.8.8.2.m1.1.1.cmml"><mi id="A2.T1.8.8.2.m1.1.1.2" xref="A2.T1.8.8.2.m1.1.1.2.cmml">t</mi><mi id="A2.T1.8.8.2.m1.1.1.3" xref="A2.T1.8.8.2.m1.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="A2.T1.8.8.2.m1.1b"><apply id="A2.T1.8.8.2.m1.1.1.cmml" xref="A2.T1.8.8.2.m1.1.1"><csymbol cd="ambiguous" id="A2.T1.8.8.2.m1.1.1.1.cmml" xref="A2.T1.8.8.2.m1.1.1">subscript</csymbol><ci id="A2.T1.8.8.2.m1.1.1.2.cmml" xref="A2.T1.8.8.2.m1.1.1.2">ğ‘¡</ci><ci id="A2.T1.8.8.2.m1.1.1.3.cmml" xref="A2.T1.8.8.2.m1.1.1.3">ğ‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.8.8.2.m1.1c">t_{c}</annotation><annotation encoding="application/x-llamapun" id="A2.T1.8.8.2.m1.1d">italic_t start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="A2.T1.10.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T1.9.9.1"><math alttext="c_{i}" class="ltx_Math" display="inline" id="A2.T1.9.9.1.m1.1"><semantics id="A2.T1.9.9.1.m1.1a"><msub id="A2.T1.9.9.1.m1.1.1" xref="A2.T1.9.9.1.m1.1.1.cmml"><mi id="A2.T1.9.9.1.m1.1.1.2" xref="A2.T1.9.9.1.m1.1.1.2.cmml">c</mi><mi id="A2.T1.9.9.1.m1.1.1.3" xref="A2.T1.9.9.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A2.T1.9.9.1.m1.1b"><apply id="A2.T1.9.9.1.m1.1.1.cmml" xref="A2.T1.9.9.1.m1.1.1"><csymbol cd="ambiguous" id="A2.T1.9.9.1.m1.1.1.1.cmml" xref="A2.T1.9.9.1.m1.1.1">subscript</csymbol><ci id="A2.T1.9.9.1.m1.1.1.2.cmml" xref="A2.T1.9.9.1.m1.1.1.2">ğ‘</ci><ci id="A2.T1.9.9.1.m1.1.1.3.cmml" xref="A2.T1.9.9.1.m1.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.9.9.1.m1.1c">c_{i}</annotation><annotation encoding="application/x-llamapun" id="A2.T1.9.9.1.m1.1d">italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="A2.T1.10.10.2">the <math alttext="i" class="ltx_Math" display="inline" id="A2.T1.10.10.2.m1.1"><semantics id="A2.T1.10.10.2.m1.1a"><mi id="A2.T1.10.10.2.m1.1.1" xref="A2.T1.10.10.2.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A2.T1.10.10.2.m1.1b"><ci id="A2.T1.10.10.2.m1.1.1.cmml" xref="A2.T1.10.10.2.m1.1.1">ğ‘–</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.10.10.2.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="A2.T1.10.10.2.m1.1d">italic_i</annotation></semantics></math>-th token of trace (in text)</td>
</tr>
<tr class="ltx_tr" id="A2.T1.12.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T1.11.11.1"><math alttext="S" class="ltx_Math" display="inline" id="A2.T1.11.11.1.m1.1"><semantics id="A2.T1.11.11.1.m1.1a"><mi id="A2.T1.11.11.1.m1.1.1" xref="A2.T1.11.11.1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="A2.T1.11.11.1.m1.1b"><ci id="A2.T1.11.11.1.m1.1.1.cmml" xref="A2.T1.11.11.1.m1.1.1">ğ‘†</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.11.11.1.m1.1c">S</annotation><annotation encoding="application/x-llamapun" id="A2.T1.11.11.1.m1.1d">italic_S</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="A2.T1.12.12.2">solution of length <math alttext="t_{s}" class="ltx_Math" display="inline" id="A2.T1.12.12.2.m1.1"><semantics id="A2.T1.12.12.2.m1.1a"><msub id="A2.T1.12.12.2.m1.1.1" xref="A2.T1.12.12.2.m1.1.1.cmml"><mi id="A2.T1.12.12.2.m1.1.1.2" xref="A2.T1.12.12.2.m1.1.1.2.cmml">t</mi><mi id="A2.T1.12.12.2.m1.1.1.3" xref="A2.T1.12.12.2.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="A2.T1.12.12.2.m1.1b"><apply id="A2.T1.12.12.2.m1.1.1.cmml" xref="A2.T1.12.12.2.m1.1.1"><csymbol cd="ambiguous" id="A2.T1.12.12.2.m1.1.1.1.cmml" xref="A2.T1.12.12.2.m1.1.1">subscript</csymbol><ci id="A2.T1.12.12.2.m1.1.1.2.cmml" xref="A2.T1.12.12.2.m1.1.1.2">ğ‘¡</ci><ci id="A2.T1.12.12.2.m1.1.1.3.cmml" xref="A2.T1.12.12.2.m1.1.1.3">ğ‘ </ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.12.12.2.m1.1c">t_{s}</annotation><annotation encoding="application/x-llamapun" id="A2.T1.12.12.2.m1.1d">italic_t start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="A2.T1.14.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T1.13.13.1"><math alttext="s_{i}" class="ltx_Math" display="inline" id="A2.T1.13.13.1.m1.1"><semantics id="A2.T1.13.13.1.m1.1a"><msub id="A2.T1.13.13.1.m1.1.1" xref="A2.T1.13.13.1.m1.1.1.cmml"><mi id="A2.T1.13.13.1.m1.1.1.2" xref="A2.T1.13.13.1.m1.1.1.2.cmml">s</mi><mi id="A2.T1.13.13.1.m1.1.1.3" xref="A2.T1.13.13.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A2.T1.13.13.1.m1.1b"><apply id="A2.T1.13.13.1.m1.1.1.cmml" xref="A2.T1.13.13.1.m1.1.1"><csymbol cd="ambiguous" id="A2.T1.13.13.1.m1.1.1.1.cmml" xref="A2.T1.13.13.1.m1.1.1">subscript</csymbol><ci id="A2.T1.13.13.1.m1.1.1.2.cmml" xref="A2.T1.13.13.1.m1.1.1.2">ğ‘ </ci><ci id="A2.T1.13.13.1.m1.1.1.3.cmml" xref="A2.T1.13.13.1.m1.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.13.13.1.m1.1c">s_{i}</annotation><annotation encoding="application/x-llamapun" id="A2.T1.13.13.1.m1.1d">italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="A2.T1.14.14.2">the <math alttext="i" class="ltx_Math" display="inline" id="A2.T1.14.14.2.m1.1"><semantics id="A2.T1.14.14.2.m1.1a"><mi id="A2.T1.14.14.2.m1.1.1" xref="A2.T1.14.14.2.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A2.T1.14.14.2.m1.1b"><ci id="A2.T1.14.14.2.m1.1.1.cmml" xref="A2.T1.14.14.2.m1.1.1">ğ‘–</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.14.14.2.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="A2.T1.14.14.2.m1.1d">italic_i</annotation></semantics></math>-th token of solution (in text)</td>
</tr>
<tr class="ltx_tr" id="A2.T1.16.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T1.15.15.1"><math alttext="Z" class="ltx_Math" display="inline" id="A2.T1.15.15.1.m1.1"><semantics id="A2.T1.15.15.1.m1.1a"><mi id="A2.T1.15.15.1.m1.1.1" xref="A2.T1.15.15.1.m1.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="A2.T1.15.15.1.m1.1b"><ci id="A2.T1.15.15.1.m1.1.1.cmml" xref="A2.T1.15.15.1.m1.1.1">ğ‘</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.15.15.1.m1.1c">Z</annotation><annotation encoding="application/x-llamapun" id="A2.T1.15.15.1.m1.1d">italic_Z</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="A2.T1.16.16.2">the complete latent reasoning traces of length <math alttext="t_{z}" class="ltx_Math" display="inline" id="A2.T1.16.16.2.m1.1"><semantics id="A2.T1.16.16.2.m1.1a"><msub id="A2.T1.16.16.2.m1.1.1" xref="A2.T1.16.16.2.m1.1.1.cmml"><mi id="A2.T1.16.16.2.m1.1.1.2" xref="A2.T1.16.16.2.m1.1.1.2.cmml">t</mi><mi id="A2.T1.16.16.2.m1.1.1.3" xref="A2.T1.16.16.2.m1.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="A2.T1.16.16.2.m1.1b"><apply id="A2.T1.16.16.2.m1.1.1.cmml" xref="A2.T1.16.16.2.m1.1.1"><csymbol cd="ambiguous" id="A2.T1.16.16.2.m1.1.1.1.cmml" xref="A2.T1.16.16.2.m1.1.1">subscript</csymbol><ci id="A2.T1.16.16.2.m1.1.1.2.cmml" xref="A2.T1.16.16.2.m1.1.1.2">ğ‘¡</ci><ci id="A2.T1.16.16.2.m1.1.1.3.cmml" xref="A2.T1.16.16.2.m1.1.1.3">ğ‘§</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.16.16.2.m1.1c">t_{z}</annotation><annotation encoding="application/x-llamapun" id="A2.T1.16.16.2.m1.1d">italic_t start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="A2.T1.18.18">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T1.17.17.1"><math alttext="z_{i}" class="ltx_Math" display="inline" id="A2.T1.17.17.1.m1.1"><semantics id="A2.T1.17.17.1.m1.1a"><msub id="A2.T1.17.17.1.m1.1.1" xref="A2.T1.17.17.1.m1.1.1.cmml"><mi id="A2.T1.17.17.1.m1.1.1.2" xref="A2.T1.17.17.1.m1.1.1.2.cmml">z</mi><mi id="A2.T1.17.17.1.m1.1.1.3" xref="A2.T1.17.17.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A2.T1.17.17.1.m1.1b"><apply id="A2.T1.17.17.1.m1.1.1.cmml" xref="A2.T1.17.17.1.m1.1.1"><csymbol cd="ambiguous" id="A2.T1.17.17.1.m1.1.1.1.cmml" xref="A2.T1.17.17.1.m1.1.1">subscript</csymbol><ci id="A2.T1.17.17.1.m1.1.1.2.cmml" xref="A2.T1.17.17.1.m1.1.1.2">ğ‘§</ci><ci id="A2.T1.17.17.1.m1.1.1.3.cmml" xref="A2.T1.17.17.1.m1.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.17.17.1.m1.1c">z_{i}</annotation><annotation encoding="application/x-llamapun" id="A2.T1.17.17.1.m1.1d">italic_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="A2.T1.18.18.2">the <math alttext="i" class="ltx_Math" display="inline" id="A2.T1.18.18.2.m1.1"><semantics id="A2.T1.18.18.2.m1.1a"><mi id="A2.T1.18.18.2.m1.1.1" xref="A2.T1.18.18.2.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A2.T1.18.18.2.m1.1b"><ci id="A2.T1.18.18.2.m1.1.1.cmml" xref="A2.T1.18.18.2.m1.1.1">ğ‘–</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.18.18.2.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="A2.T1.18.18.2.m1.1d">italic_i</annotation></semantics></math>-th token of latent trace</td>
</tr>
<tr class="ltx_tr" id="A2.T1.19.19">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T1.19.19.1"><math alttext="r=t_{c}/t_{z}" class="ltx_Math" display="inline" id="A2.T1.19.19.1.m1.1"><semantics id="A2.T1.19.19.1.m1.1a"><mrow id="A2.T1.19.19.1.m1.1.1" xref="A2.T1.19.19.1.m1.1.1.cmml"><mi id="A2.T1.19.19.1.m1.1.1.2" xref="A2.T1.19.19.1.m1.1.1.2.cmml">r</mi><mo id="A2.T1.19.19.1.m1.1.1.1" xref="A2.T1.19.19.1.m1.1.1.1.cmml">=</mo><mrow id="A2.T1.19.19.1.m1.1.1.3" xref="A2.T1.19.19.1.m1.1.1.3.cmml"><msub id="A2.T1.19.19.1.m1.1.1.3.2" xref="A2.T1.19.19.1.m1.1.1.3.2.cmml"><mi id="A2.T1.19.19.1.m1.1.1.3.2.2" xref="A2.T1.19.19.1.m1.1.1.3.2.2.cmml">t</mi><mi id="A2.T1.19.19.1.m1.1.1.3.2.3" xref="A2.T1.19.19.1.m1.1.1.3.2.3.cmml">c</mi></msub><mo id="A2.T1.19.19.1.m1.1.1.3.1" xref="A2.T1.19.19.1.m1.1.1.3.1.cmml">/</mo><msub id="A2.T1.19.19.1.m1.1.1.3.3" xref="A2.T1.19.19.1.m1.1.1.3.3.cmml"><mi id="A2.T1.19.19.1.m1.1.1.3.3.2" xref="A2.T1.19.19.1.m1.1.1.3.3.2.cmml">t</mi><mi id="A2.T1.19.19.1.m1.1.1.3.3.3" xref="A2.T1.19.19.1.m1.1.1.3.3.3.cmml">z</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.T1.19.19.1.m1.1b"><apply id="A2.T1.19.19.1.m1.1.1.cmml" xref="A2.T1.19.19.1.m1.1.1"><eq id="A2.T1.19.19.1.m1.1.1.1.cmml" xref="A2.T1.19.19.1.m1.1.1.1"></eq><ci id="A2.T1.19.19.1.m1.1.1.2.cmml" xref="A2.T1.19.19.1.m1.1.1.2">ğ‘Ÿ</ci><apply id="A2.T1.19.19.1.m1.1.1.3.cmml" xref="A2.T1.19.19.1.m1.1.1.3"><divide id="A2.T1.19.19.1.m1.1.1.3.1.cmml" xref="A2.T1.19.19.1.m1.1.1.3.1"></divide><apply id="A2.T1.19.19.1.m1.1.1.3.2.cmml" xref="A2.T1.19.19.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="A2.T1.19.19.1.m1.1.1.3.2.1.cmml" xref="A2.T1.19.19.1.m1.1.1.3.2">subscript</csymbol><ci id="A2.T1.19.19.1.m1.1.1.3.2.2.cmml" xref="A2.T1.19.19.1.m1.1.1.3.2.2">ğ‘¡</ci><ci id="A2.T1.19.19.1.m1.1.1.3.2.3.cmml" xref="A2.T1.19.19.1.m1.1.1.3.2.3">ğ‘</ci></apply><apply id="A2.T1.19.19.1.m1.1.1.3.3.cmml" xref="A2.T1.19.19.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="A2.T1.19.19.1.m1.1.1.3.3.1.cmml" xref="A2.T1.19.19.1.m1.1.1.3.3">subscript</csymbol><ci id="A2.T1.19.19.1.m1.1.1.3.3.2.cmml" xref="A2.T1.19.19.1.m1.1.1.3.3.2">ğ‘¡</ci><ci id="A2.T1.19.19.1.m1.1.1.3.3.3.cmml" xref="A2.T1.19.19.1.m1.1.1.3.3.3">ğ‘§</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.19.19.1.m1.1c">r=t_{c}/t_{z}</annotation><annotation encoding="application/x-llamapun" id="A2.T1.19.19.1.m1.1d">italic_r = italic_t start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT / italic_t start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="A2.T1.19.19.2">compression rate</td>
</tr>
<tr class="ltx_tr" id="A2.T1.20.20">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T1.20.20.1"><math alttext="m" class="ltx_Math" display="inline" id="A2.T1.20.20.1.m1.1"><semantics id="A2.T1.20.20.1.m1.1a"><mi id="A2.T1.20.20.1.m1.1.1" xref="A2.T1.20.20.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="A2.T1.20.20.1.m1.1b"><ci id="A2.T1.20.20.1.m1.1.1.cmml" xref="A2.T1.20.20.1.m1.1.1">ğ‘š</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.20.20.1.m1.1c">m</annotation><annotation encoding="application/x-llamapun" id="A2.T1.20.20.1.m1.1d">italic_m</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="A2.T1.20.20.2">number of trace tokens to be replaced by latent tokens during training</td>
</tr>
<tr class="ltx_tr" id="A2.T1.21.21">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T1.21.21.1"><math alttext="{\widetilde{X}}" class="ltx_Math" display="inline" id="A2.T1.21.21.1.m1.1"><semantics id="A2.T1.21.21.1.m1.1a"><mover accent="true" id="A2.T1.21.21.1.m1.1.1" xref="A2.T1.21.21.1.m1.1.1.cmml"><mi id="A2.T1.21.21.1.m1.1.1.2" xref="A2.T1.21.21.1.m1.1.1.2.cmml">X</mi><mo id="A2.T1.21.21.1.m1.1.1.1" xref="A2.T1.21.21.1.m1.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="A2.T1.21.21.1.m1.1b"><apply id="A2.T1.21.21.1.m1.1.1.cmml" xref="A2.T1.21.21.1.m1.1.1"><ci id="A2.T1.21.21.1.m1.1.1.1.cmml" xref="A2.T1.21.21.1.m1.1.1.1">~</ci><ci id="A2.T1.21.21.1.m1.1.1.2.cmml" xref="A2.T1.21.21.1.m1.1.1.2">ğ‘‹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.21.21.1.m1.1c">{\widetilde{X}}</annotation><annotation encoding="application/x-llamapun" id="A2.T1.21.21.1.m1.1d">over~ start_ARG italic_X end_ARG</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="A2.T1.21.21.2">modified input with mixed text and latent tokens</td>
</tr>
<tr class="ltx_tr" id="A2.T1.22.22">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A2.T1.22.22.1"><math alttext="\mathcal{E}" class="ltx_Math" display="inline" id="A2.T1.22.22.1.m1.1"><semantics id="A2.T1.22.22.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="A2.T1.22.22.1.m1.1.1" xref="A2.T1.22.22.1.m1.1.1.cmml">â„°</mi><annotation-xml encoding="MathML-Content" id="A2.T1.22.22.1.m1.1b"><ci id="A2.T1.22.22.1.m1.1.1.cmml" xref="A2.T1.22.22.1.m1.1.1">â„°</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.22.22.1.m1.1c">\mathcal{E}</annotation><annotation encoding="application/x-llamapun" id="A2.T1.22.22.1.m1.1d">caligraphic_E</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left ltx_border_t" id="A2.T1.22.22.2">codebook of VQ-VAE</td>
</tr>
<tr class="ltx_tr" id="A2.T1.25.25">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T1.23.23.1"><math alttext="e_{i}" class="ltx_Math" display="inline" id="A2.T1.23.23.1.m1.1"><semantics id="A2.T1.23.23.1.m1.1a"><msub id="A2.T1.23.23.1.m1.1.1" xref="A2.T1.23.23.1.m1.1.1.cmml"><mi id="A2.T1.23.23.1.m1.1.1.2" xref="A2.T1.23.23.1.m1.1.1.2.cmml">e</mi><mi id="A2.T1.23.23.1.m1.1.1.3" xref="A2.T1.23.23.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A2.T1.23.23.1.m1.1b"><apply id="A2.T1.23.23.1.m1.1.1.cmml" xref="A2.T1.23.23.1.m1.1.1"><csymbol cd="ambiguous" id="A2.T1.23.23.1.m1.1.1.1.cmml" xref="A2.T1.23.23.1.m1.1.1">subscript</csymbol><ci id="A2.T1.23.23.1.m1.1.1.2.cmml" xref="A2.T1.23.23.1.m1.1.1.2">ğ‘’</ci><ci id="A2.T1.23.23.1.m1.1.1.3.cmml" xref="A2.T1.23.23.1.m1.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.23.23.1.m1.1c">e_{i}</annotation><annotation encoding="application/x-llamapun" id="A2.T1.23.23.1.m1.1d">italic_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="A2.T1.25.25.3">the <math alttext="i" class="ltx_Math" display="inline" id="A2.T1.24.24.2.m1.1"><semantics id="A2.T1.24.24.2.m1.1a"><mi id="A2.T1.24.24.2.m1.1.1" xref="A2.T1.24.24.2.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A2.T1.24.24.2.m1.1b"><ci id="A2.T1.24.24.2.m1.1.1.cmml" xref="A2.T1.24.24.2.m1.1.1">ğ‘–</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.24.24.2.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="A2.T1.24.24.2.m1.1d">italic_i</annotation></semantics></math>-th vector in the codebook, which corresponds to the <math alttext="i" class="ltx_Math" display="inline" id="A2.T1.25.25.3.m2.1"><semantics id="A2.T1.25.25.3.m2.1a"><mi id="A2.T1.25.25.3.m2.1.1" xref="A2.T1.25.25.3.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A2.T1.25.25.3.m2.1b"><ci id="A2.T1.25.25.3.m2.1.1.cmml" xref="A2.T1.25.25.3.m2.1.1">ğ‘–</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.25.25.3.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="A2.T1.25.25.3.m2.1d">italic_i</annotation></semantics></math>-th latent token</td>
</tr>
<tr class="ltx_tr" id="A2.T1.27.27">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T1.26.26.1"><math alttext="d" class="ltx_Math" display="inline" id="A2.T1.26.26.1.m1.1"><semantics id="A2.T1.26.26.1.m1.1a"><mi id="A2.T1.26.26.1.m1.1.1" xref="A2.T1.26.26.1.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="A2.T1.26.26.1.m1.1b"><ci id="A2.T1.26.26.1.m1.1.1.cmml" xref="A2.T1.26.26.1.m1.1.1">ğ‘‘</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.26.26.1.m1.1c">d</annotation><annotation encoding="application/x-llamapun" id="A2.T1.26.26.1.m1.1d">italic_d</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="A2.T1.27.27.2">dimension of <math alttext="e_{i}" class="ltx_Math" display="inline" id="A2.T1.27.27.2.m1.1"><semantics id="A2.T1.27.27.2.m1.1a"><msub id="A2.T1.27.27.2.m1.1.1" xref="A2.T1.27.27.2.m1.1.1.cmml"><mi id="A2.T1.27.27.2.m1.1.1.2" xref="A2.T1.27.27.2.m1.1.1.2.cmml">e</mi><mi id="A2.T1.27.27.2.m1.1.1.3" xref="A2.T1.27.27.2.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A2.T1.27.27.2.m1.1b"><apply id="A2.T1.27.27.2.m1.1.1.cmml" xref="A2.T1.27.27.2.m1.1.1"><csymbol cd="ambiguous" id="A2.T1.27.27.2.m1.1.1.1.cmml" xref="A2.T1.27.27.2.m1.1.1">subscript</csymbol><ci id="A2.T1.27.27.2.m1.1.1.2.cmml" xref="A2.T1.27.27.2.m1.1.1.2">ğ‘’</ci><ci id="A2.T1.27.27.2.m1.1.1.3.cmml" xref="A2.T1.27.27.2.m1.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.27.27.2.m1.1c">e_{i}</annotation><annotation encoding="application/x-llamapun" id="A2.T1.27.27.2.m1.1d">italic_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>s</td>
</tr>
<tr class="ltx_tr" id="A2.T1.28.28">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T1.28.28.1"><math alttext="{\mathcal{V}}" class="ltx_Math" display="inline" id="A2.T1.28.28.1.m1.1"><semantics id="A2.T1.28.28.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="A2.T1.28.28.1.m1.1.1" xref="A2.T1.28.28.1.m1.1.1.cmml">ğ’±</mi><annotation-xml encoding="MathML-Content" id="A2.T1.28.28.1.m1.1b"><ci id="A2.T1.28.28.1.m1.1.1.cmml" xref="A2.T1.28.28.1.m1.1.1">ğ’±</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.28.28.1.m1.1c">{\mathcal{V}}</annotation><annotation encoding="application/x-llamapun" id="A2.T1.28.28.1.m1.1d">caligraphic_V</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="A2.T1.28.28.2">vocabulary of text tokens</td>
</tr>
<tr class="ltx_tr" id="A2.T1.29.29">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T1.29.29.1"><math alttext="L" class="ltx_Math" display="inline" id="A2.T1.29.29.1.m1.1"><semantics id="A2.T1.29.29.1.m1.1a"><mi id="A2.T1.29.29.1.m1.1.1" xref="A2.T1.29.29.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="A2.T1.29.29.1.m1.1b"><ci id="A2.T1.29.29.1.m1.1.1.cmml" xref="A2.T1.29.29.1.m1.1.1">ğ¿</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.29.29.1.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="A2.T1.29.29.1.m1.1d">italic_L</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="A2.T1.29.29.2">chunk size</td>
</tr>
<tr class="ltx_tr" id="A2.T1.32.32">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T1.30.30.1"><math alttext="{f_{\text{enc}}}(\cdot)" class="ltx_Math" display="inline" id="A2.T1.30.30.1.m1.1"><semantics id="A2.T1.30.30.1.m1.1a"><mrow id="A2.T1.30.30.1.m1.1.2" xref="A2.T1.30.30.1.m1.1.2.cmml"><msub id="A2.T1.30.30.1.m1.1.2.2" xref="A2.T1.30.30.1.m1.1.2.2.cmml"><mi id="A2.T1.30.30.1.m1.1.2.2.2" xref="A2.T1.30.30.1.m1.1.2.2.2.cmml">f</mi><mtext id="A2.T1.30.30.1.m1.1.2.2.3" xref="A2.T1.30.30.1.m1.1.2.2.3a.cmml">enc</mtext></msub><mo id="A2.T1.30.30.1.m1.1.2.1" xref="A2.T1.30.30.1.m1.1.2.1.cmml">â¢</mo><mrow id="A2.T1.30.30.1.m1.1.2.3.2" xref="A2.T1.30.30.1.m1.1.2.cmml"><mo id="A2.T1.30.30.1.m1.1.2.3.2.1" stretchy="false" xref="A2.T1.30.30.1.m1.1.2.cmml">(</mo><mo id="A2.T1.30.30.1.m1.1.1" lspace="0em" rspace="0em" xref="A2.T1.30.30.1.m1.1.1.cmml">â‹…</mo><mo id="A2.T1.30.30.1.m1.1.2.3.2.2" stretchy="false" xref="A2.T1.30.30.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.T1.30.30.1.m1.1b"><apply id="A2.T1.30.30.1.m1.1.2.cmml" xref="A2.T1.30.30.1.m1.1.2"><times id="A2.T1.30.30.1.m1.1.2.1.cmml" xref="A2.T1.30.30.1.m1.1.2.1"></times><apply id="A2.T1.30.30.1.m1.1.2.2.cmml" xref="A2.T1.30.30.1.m1.1.2.2"><csymbol cd="ambiguous" id="A2.T1.30.30.1.m1.1.2.2.1.cmml" xref="A2.T1.30.30.1.m1.1.2.2">subscript</csymbol><ci id="A2.T1.30.30.1.m1.1.2.2.2.cmml" xref="A2.T1.30.30.1.m1.1.2.2.2">ğ‘“</ci><ci id="A2.T1.30.30.1.m1.1.2.2.3a.cmml" xref="A2.T1.30.30.1.m1.1.2.2.3"><mtext id="A2.T1.30.30.1.m1.1.2.2.3.cmml" mathsize="70%" xref="A2.T1.30.30.1.m1.1.2.2.3">enc</mtext></ci></apply><ci id="A2.T1.30.30.1.m1.1.1.cmml" xref="A2.T1.30.30.1.m1.1.1">â‹…</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.30.30.1.m1.1c">{f_{\text{enc}}}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="A2.T1.30.30.1.m1.1d">italic_f start_POSTSUBSCRIPT enc end_POSTSUBSCRIPT ( â‹… )</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="A2.T1.32.32.3">encodes a chunk of <math alttext="L" class="ltx_Math" display="inline" id="A2.T1.31.31.2.m1.1"><semantics id="A2.T1.31.31.2.m1.1a"><mi id="A2.T1.31.31.2.m1.1.1" xref="A2.T1.31.31.2.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="A2.T1.31.31.2.m1.1b"><ci id="A2.T1.31.31.2.m1.1.1.cmml" xref="A2.T1.31.31.2.m1.1.1">ğ¿</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.31.31.2.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="A2.T1.31.31.2.m1.1d">italic_L</annotation></semantics></math> text tokens to <math alttext="\frac{L}{r}" class="ltx_Math" display="inline" id="A2.T1.32.32.3.m2.1"><semantics id="A2.T1.32.32.3.m2.1a"><mfrac id="A2.T1.32.32.3.m2.1.1" xref="A2.T1.32.32.3.m2.1.1.cmml"><mi id="A2.T1.32.32.3.m2.1.1.2" xref="A2.T1.32.32.3.m2.1.1.2.cmml">L</mi><mi id="A2.T1.32.32.3.m2.1.1.3" xref="A2.T1.32.32.3.m2.1.1.3.cmml">r</mi></mfrac><annotation-xml encoding="MathML-Content" id="A2.T1.32.32.3.m2.1b"><apply id="A2.T1.32.32.3.m2.1.1.cmml" xref="A2.T1.32.32.3.m2.1.1"><divide id="A2.T1.32.32.3.m2.1.1.1.cmml" xref="A2.T1.32.32.3.m2.1.1"></divide><ci id="A2.T1.32.32.3.m2.1.1.2.cmml" xref="A2.T1.32.32.3.m2.1.1.2">ğ¿</ci><ci id="A2.T1.32.32.3.m2.1.1.3.cmml" xref="A2.T1.32.32.3.m2.1.1.3">ğ‘Ÿ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.32.32.3.m2.1c">\frac{L}{r}</annotation><annotation encoding="application/x-llamapun" id="A2.T1.32.32.3.m2.1d">divide start_ARG italic_L end_ARG start_ARG italic_r end_ARG</annotation></semantics></math> embedding vectors</td>
</tr>
<tr class="ltx_tr" id="A2.T1.35.35">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T1.33.33.1"><math alttext="\bar{X}=\bar{x}_{1},\ldots,\bar{x}_{\frac{L}{r}}" class="ltx_Math" display="inline" id="A2.T1.33.33.1.m1.3"><semantics id="A2.T1.33.33.1.m1.3a"><mrow id="A2.T1.33.33.1.m1.3.3" xref="A2.T1.33.33.1.m1.3.3.cmml"><mover accent="true" id="A2.T1.33.33.1.m1.3.3.4" xref="A2.T1.33.33.1.m1.3.3.4.cmml"><mi id="A2.T1.33.33.1.m1.3.3.4.2" xref="A2.T1.33.33.1.m1.3.3.4.2.cmml">X</mi><mo id="A2.T1.33.33.1.m1.3.3.4.1" xref="A2.T1.33.33.1.m1.3.3.4.1.cmml">Â¯</mo></mover><mo id="A2.T1.33.33.1.m1.3.3.3" xref="A2.T1.33.33.1.m1.3.3.3.cmml">=</mo><mrow id="A2.T1.33.33.1.m1.3.3.2.2" xref="A2.T1.33.33.1.m1.3.3.2.3.cmml"><msub id="A2.T1.33.33.1.m1.2.2.1.1.1" xref="A2.T1.33.33.1.m1.2.2.1.1.1.cmml"><mover accent="true" id="A2.T1.33.33.1.m1.2.2.1.1.1.2" xref="A2.T1.33.33.1.m1.2.2.1.1.1.2.cmml"><mi id="A2.T1.33.33.1.m1.2.2.1.1.1.2.2" xref="A2.T1.33.33.1.m1.2.2.1.1.1.2.2.cmml">x</mi><mo id="A2.T1.33.33.1.m1.2.2.1.1.1.2.1" xref="A2.T1.33.33.1.m1.2.2.1.1.1.2.1.cmml">Â¯</mo></mover><mn id="A2.T1.33.33.1.m1.2.2.1.1.1.3" xref="A2.T1.33.33.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="A2.T1.33.33.1.m1.3.3.2.2.3" xref="A2.T1.33.33.1.m1.3.3.2.3.cmml">,</mo><mi id="A2.T1.33.33.1.m1.1.1" mathvariant="normal" xref="A2.T1.33.33.1.m1.1.1.cmml">â€¦</mi><mo id="A2.T1.33.33.1.m1.3.3.2.2.4" xref="A2.T1.33.33.1.m1.3.3.2.3.cmml">,</mo><msub id="A2.T1.33.33.1.m1.3.3.2.2.2" xref="A2.T1.33.33.1.m1.3.3.2.2.2.cmml"><mover accent="true" id="A2.T1.33.33.1.m1.3.3.2.2.2.2" xref="A2.T1.33.33.1.m1.3.3.2.2.2.2.cmml"><mi id="A2.T1.33.33.1.m1.3.3.2.2.2.2.2" xref="A2.T1.33.33.1.m1.3.3.2.2.2.2.2.cmml">x</mi><mo id="A2.T1.33.33.1.m1.3.3.2.2.2.2.1" xref="A2.T1.33.33.1.m1.3.3.2.2.2.2.1.cmml">Â¯</mo></mover><mfrac id="A2.T1.33.33.1.m1.3.3.2.2.2.3" xref="A2.T1.33.33.1.m1.3.3.2.2.2.3.cmml"><mi id="A2.T1.33.33.1.m1.3.3.2.2.2.3.2" xref="A2.T1.33.33.1.m1.3.3.2.2.2.3.2.cmml">L</mi><mi id="A2.T1.33.33.1.m1.3.3.2.2.2.3.3" xref="A2.T1.33.33.1.m1.3.3.2.2.2.3.3.cmml">r</mi></mfrac></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.T1.33.33.1.m1.3b"><apply id="A2.T1.33.33.1.m1.3.3.cmml" xref="A2.T1.33.33.1.m1.3.3"><eq id="A2.T1.33.33.1.m1.3.3.3.cmml" xref="A2.T1.33.33.1.m1.3.3.3"></eq><apply id="A2.T1.33.33.1.m1.3.3.4.cmml" xref="A2.T1.33.33.1.m1.3.3.4"><ci id="A2.T1.33.33.1.m1.3.3.4.1.cmml" xref="A2.T1.33.33.1.m1.3.3.4.1">Â¯</ci><ci id="A2.T1.33.33.1.m1.3.3.4.2.cmml" xref="A2.T1.33.33.1.m1.3.3.4.2">ğ‘‹</ci></apply><list id="A2.T1.33.33.1.m1.3.3.2.3.cmml" xref="A2.T1.33.33.1.m1.3.3.2.2"><apply id="A2.T1.33.33.1.m1.2.2.1.1.1.cmml" xref="A2.T1.33.33.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="A2.T1.33.33.1.m1.2.2.1.1.1.1.cmml" xref="A2.T1.33.33.1.m1.2.2.1.1.1">subscript</csymbol><apply id="A2.T1.33.33.1.m1.2.2.1.1.1.2.cmml" xref="A2.T1.33.33.1.m1.2.2.1.1.1.2"><ci id="A2.T1.33.33.1.m1.2.2.1.1.1.2.1.cmml" xref="A2.T1.33.33.1.m1.2.2.1.1.1.2.1">Â¯</ci><ci id="A2.T1.33.33.1.m1.2.2.1.1.1.2.2.cmml" xref="A2.T1.33.33.1.m1.2.2.1.1.1.2.2">ğ‘¥</ci></apply><cn id="A2.T1.33.33.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="A2.T1.33.33.1.m1.2.2.1.1.1.3">1</cn></apply><ci id="A2.T1.33.33.1.m1.1.1.cmml" xref="A2.T1.33.33.1.m1.1.1">â€¦</ci><apply id="A2.T1.33.33.1.m1.3.3.2.2.2.cmml" xref="A2.T1.33.33.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="A2.T1.33.33.1.m1.3.3.2.2.2.1.cmml" xref="A2.T1.33.33.1.m1.3.3.2.2.2">subscript</csymbol><apply id="A2.T1.33.33.1.m1.3.3.2.2.2.2.cmml" xref="A2.T1.33.33.1.m1.3.3.2.2.2.2"><ci id="A2.T1.33.33.1.m1.3.3.2.2.2.2.1.cmml" xref="A2.T1.33.33.1.m1.3.3.2.2.2.2.1">Â¯</ci><ci id="A2.T1.33.33.1.m1.3.3.2.2.2.2.2.cmml" xref="A2.T1.33.33.1.m1.3.3.2.2.2.2.2">ğ‘¥</ci></apply><apply id="A2.T1.33.33.1.m1.3.3.2.2.2.3.cmml" xref="A2.T1.33.33.1.m1.3.3.2.2.2.3"><divide id="A2.T1.33.33.1.m1.3.3.2.2.2.3.1.cmml" xref="A2.T1.33.33.1.m1.3.3.2.2.2.3"></divide><ci id="A2.T1.33.33.1.m1.3.3.2.2.2.3.2.cmml" xref="A2.T1.33.33.1.m1.3.3.2.2.2.3.2">ğ¿</ci><ci id="A2.T1.33.33.1.m1.3.3.2.2.2.3.3.cmml" xref="A2.T1.33.33.1.m1.3.3.2.2.2.3.3">ğ‘Ÿ</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.33.33.1.m1.3c">\bar{X}=\bar{x}_{1},\ldots,\bar{x}_{\frac{L}{r}}</annotation><annotation encoding="application/x-llamapun" id="A2.T1.33.33.1.m1.3d">overÂ¯ start_ARG italic_X end_ARG = overÂ¯ start_ARG italic_x end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , â€¦ , overÂ¯ start_ARG italic_x end_ARG start_POSTSUBSCRIPT divide start_ARG italic_L end_ARG start_ARG italic_r end_ARG end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="A2.T1.35.35.3">embedding vectors of <math alttext="X" class="ltx_Math" display="inline" id="A2.T1.34.34.2.m1.1"><semantics id="A2.T1.34.34.2.m1.1a"><mi id="A2.T1.34.34.2.m1.1.1" xref="A2.T1.34.34.2.m1.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="A2.T1.34.34.2.m1.1b"><ci id="A2.T1.34.34.2.m1.1.1.cmml" xref="A2.T1.34.34.2.m1.1.1">ğ‘‹</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.34.34.2.m1.1c">X</annotation><annotation encoding="application/x-llamapun" id="A2.T1.34.34.2.m1.1d">italic_X</annotation></semantics></math> outputted by <math alttext="{f_{\text{enc}}}(\cdot)" class="ltx_Math" display="inline" id="A2.T1.35.35.3.m2.1"><semantics id="A2.T1.35.35.3.m2.1a"><mrow id="A2.T1.35.35.3.m2.1.2" xref="A2.T1.35.35.3.m2.1.2.cmml"><msub id="A2.T1.35.35.3.m2.1.2.2" xref="A2.T1.35.35.3.m2.1.2.2.cmml"><mi id="A2.T1.35.35.3.m2.1.2.2.2" xref="A2.T1.35.35.3.m2.1.2.2.2.cmml">f</mi><mtext id="A2.T1.35.35.3.m2.1.2.2.3" xref="A2.T1.35.35.3.m2.1.2.2.3a.cmml">enc</mtext></msub><mo id="A2.T1.35.35.3.m2.1.2.1" xref="A2.T1.35.35.3.m2.1.2.1.cmml">â¢</mo><mrow id="A2.T1.35.35.3.m2.1.2.3.2" xref="A2.T1.35.35.3.m2.1.2.cmml"><mo id="A2.T1.35.35.3.m2.1.2.3.2.1" stretchy="false" xref="A2.T1.35.35.3.m2.1.2.cmml">(</mo><mo id="A2.T1.35.35.3.m2.1.1" lspace="0em" rspace="0em" xref="A2.T1.35.35.3.m2.1.1.cmml">â‹…</mo><mo id="A2.T1.35.35.3.m2.1.2.3.2.2" stretchy="false" xref="A2.T1.35.35.3.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.T1.35.35.3.m2.1b"><apply id="A2.T1.35.35.3.m2.1.2.cmml" xref="A2.T1.35.35.3.m2.1.2"><times id="A2.T1.35.35.3.m2.1.2.1.cmml" xref="A2.T1.35.35.3.m2.1.2.1"></times><apply id="A2.T1.35.35.3.m2.1.2.2.cmml" xref="A2.T1.35.35.3.m2.1.2.2"><csymbol cd="ambiguous" id="A2.T1.35.35.3.m2.1.2.2.1.cmml" xref="A2.T1.35.35.3.m2.1.2.2">subscript</csymbol><ci id="A2.T1.35.35.3.m2.1.2.2.2.cmml" xref="A2.T1.35.35.3.m2.1.2.2.2">ğ‘“</ci><ci id="A2.T1.35.35.3.m2.1.2.2.3a.cmml" xref="A2.T1.35.35.3.m2.1.2.2.3"><mtext id="A2.T1.35.35.3.m2.1.2.2.3.cmml" mathsize="70%" xref="A2.T1.35.35.3.m2.1.2.2.3">enc</mtext></ci></apply><ci id="A2.T1.35.35.3.m2.1.1.cmml" xref="A2.T1.35.35.3.m2.1.1">â‹…</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.35.35.3.m2.1c">{f_{\text{enc}}}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="A2.T1.35.35.3.m2.1d">italic_f start_POSTSUBSCRIPT enc end_POSTSUBSCRIPT ( â‹… )</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="A2.T1.38.38">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T1.36.36.1"><math alttext="q(\cdot)" class="ltx_Math" display="inline" id="A2.T1.36.36.1.m1.1"><semantics id="A2.T1.36.36.1.m1.1a"><mrow id="A2.T1.36.36.1.m1.1.2" xref="A2.T1.36.36.1.m1.1.2.cmml"><mi id="A2.T1.36.36.1.m1.1.2.2" xref="A2.T1.36.36.1.m1.1.2.2.cmml">q</mi><mo id="A2.T1.36.36.1.m1.1.2.1" xref="A2.T1.36.36.1.m1.1.2.1.cmml">â¢</mo><mrow id="A2.T1.36.36.1.m1.1.2.3.2" xref="A2.T1.36.36.1.m1.1.2.cmml"><mo id="A2.T1.36.36.1.m1.1.2.3.2.1" stretchy="false" xref="A2.T1.36.36.1.m1.1.2.cmml">(</mo><mo id="A2.T1.36.36.1.m1.1.1" lspace="0em" rspace="0em" xref="A2.T1.36.36.1.m1.1.1.cmml">â‹…</mo><mo id="A2.T1.36.36.1.m1.1.2.3.2.2" stretchy="false" xref="A2.T1.36.36.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.T1.36.36.1.m1.1b"><apply id="A2.T1.36.36.1.m1.1.2.cmml" xref="A2.T1.36.36.1.m1.1.2"><times id="A2.T1.36.36.1.m1.1.2.1.cmml" xref="A2.T1.36.36.1.m1.1.2.1"></times><ci id="A2.T1.36.36.1.m1.1.2.2.cmml" xref="A2.T1.36.36.1.m1.1.2.2">ğ‘</ci><ci id="A2.T1.36.36.1.m1.1.1.cmml" xref="A2.T1.36.36.1.m1.1.1">â‹…</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.36.36.1.m1.1c">q(\cdot)</annotation><annotation encoding="application/x-llamapun" id="A2.T1.36.36.1.m1.1d">italic_q ( â‹… )</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="A2.T1.38.38.3">quantization operator that replaces, e.g., <math alttext="\bar{x}_{1}" class="ltx_Math" display="inline" id="A2.T1.37.37.2.m1.1"><semantics id="A2.T1.37.37.2.m1.1a"><msub id="A2.T1.37.37.2.m1.1.1" xref="A2.T1.37.37.2.m1.1.1.cmml"><mover accent="true" id="A2.T1.37.37.2.m1.1.1.2" xref="A2.T1.37.37.2.m1.1.1.2.cmml"><mi id="A2.T1.37.37.2.m1.1.1.2.2" xref="A2.T1.37.37.2.m1.1.1.2.2.cmml">x</mi><mo id="A2.T1.37.37.2.m1.1.1.2.1" xref="A2.T1.37.37.2.m1.1.1.2.1.cmml">Â¯</mo></mover><mn id="A2.T1.37.37.2.m1.1.1.3" xref="A2.T1.37.37.2.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="A2.T1.37.37.2.m1.1b"><apply id="A2.T1.37.37.2.m1.1.1.cmml" xref="A2.T1.37.37.2.m1.1.1"><csymbol cd="ambiguous" id="A2.T1.37.37.2.m1.1.1.1.cmml" xref="A2.T1.37.37.2.m1.1.1">subscript</csymbol><apply id="A2.T1.37.37.2.m1.1.1.2.cmml" xref="A2.T1.37.37.2.m1.1.1.2"><ci id="A2.T1.37.37.2.m1.1.1.2.1.cmml" xref="A2.T1.37.37.2.m1.1.1.2.1">Â¯</ci><ci id="A2.T1.37.37.2.m1.1.1.2.2.cmml" xref="A2.T1.37.37.2.m1.1.1.2.2">ğ‘¥</ci></apply><cn id="A2.T1.37.37.2.m1.1.1.3.cmml" type="integer" xref="A2.T1.37.37.2.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.37.37.2.m1.1c">\bar{x}_{1}</annotation><annotation encoding="application/x-llamapun" id="A2.T1.37.37.2.m1.1d">overÂ¯ start_ARG italic_x end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> by its nearest neighbor in <math alttext="{\mathcal{E}}" class="ltx_Math" display="inline" id="A2.T1.38.38.3.m2.1"><semantics id="A2.T1.38.38.3.m2.1a"><mi class="ltx_font_mathcaligraphic" id="A2.T1.38.38.3.m2.1.1" xref="A2.T1.38.38.3.m2.1.1.cmml">â„°</mi><annotation-xml encoding="MathML-Content" id="A2.T1.38.38.3.m2.1b"><ci id="A2.T1.38.38.3.m2.1.1.cmml" xref="A2.T1.38.38.3.m2.1.1">â„°</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.38.38.3.m2.1c">{\mathcal{E}}</annotation><annotation encoding="application/x-llamapun" id="A2.T1.38.38.3.m2.1d">caligraphic_E</annotation></semantics></math>:</td>
</tr>
<tr class="ltx_tr" id="A2.T1.39.39">
<th class="ltx_td ltx_th ltx_th_row" id="A2.T1.39.39.2"></th>
<td class="ltx_td ltx_align_left" id="A2.T1.39.39.1">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <math alttext="g(\bar{x}_{1})=\operatorname*{argmin}_{e_{i}\in{\mathcal{E}}}\left\|e_{i}-\bar%
{x}_{1}\right\|^{2}" class="ltx_Math" display="inline" id="A2.T1.39.39.1.m1.2"><semantics id="A2.T1.39.39.1.m1.2a"><mrow id="A2.T1.39.39.1.m1.2.2" xref="A2.T1.39.39.1.m1.2.2.cmml"><mrow id="A2.T1.39.39.1.m1.1.1.1" xref="A2.T1.39.39.1.m1.1.1.1.cmml"><mi id="A2.T1.39.39.1.m1.1.1.1.3" xref="A2.T1.39.39.1.m1.1.1.1.3.cmml">g</mi><mo id="A2.T1.39.39.1.m1.1.1.1.2" xref="A2.T1.39.39.1.m1.1.1.1.2.cmml">â¢</mo><mrow id="A2.T1.39.39.1.m1.1.1.1.1.1" xref="A2.T1.39.39.1.m1.1.1.1.1.1.1.cmml"><mo id="A2.T1.39.39.1.m1.1.1.1.1.1.2" stretchy="false" xref="A2.T1.39.39.1.m1.1.1.1.1.1.1.cmml">(</mo><msub id="A2.T1.39.39.1.m1.1.1.1.1.1.1" xref="A2.T1.39.39.1.m1.1.1.1.1.1.1.cmml"><mover accent="true" id="A2.T1.39.39.1.m1.1.1.1.1.1.1.2" xref="A2.T1.39.39.1.m1.1.1.1.1.1.1.2.cmml"><mi id="A2.T1.39.39.1.m1.1.1.1.1.1.1.2.2" xref="A2.T1.39.39.1.m1.1.1.1.1.1.1.2.2.cmml">x</mi><mo id="A2.T1.39.39.1.m1.1.1.1.1.1.1.2.1" xref="A2.T1.39.39.1.m1.1.1.1.1.1.1.2.1.cmml">Â¯</mo></mover><mn id="A2.T1.39.39.1.m1.1.1.1.1.1.1.3" xref="A2.T1.39.39.1.m1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="A2.T1.39.39.1.m1.1.1.1.1.1.3" stretchy="false" xref="A2.T1.39.39.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A2.T1.39.39.1.m1.2.2.3" rspace="0.1389em" xref="A2.T1.39.39.1.m1.2.2.3.cmml">=</mo><mrow id="A2.T1.39.39.1.m1.2.2.2" xref="A2.T1.39.39.1.m1.2.2.2.cmml"><msub id="A2.T1.39.39.1.m1.2.2.2.2" xref="A2.T1.39.39.1.m1.2.2.2.2.cmml"><mo id="A2.T1.39.39.1.m1.2.2.2.2.2" lspace="0.1389em" rspace="0em" xref="A2.T1.39.39.1.m1.2.2.2.2.2.cmml">argmin</mo><mrow id="A2.T1.39.39.1.m1.2.2.2.2.3" xref="A2.T1.39.39.1.m1.2.2.2.2.3.cmml"><msub id="A2.T1.39.39.1.m1.2.2.2.2.3.2" xref="A2.T1.39.39.1.m1.2.2.2.2.3.2.cmml"><mi id="A2.T1.39.39.1.m1.2.2.2.2.3.2.2" xref="A2.T1.39.39.1.m1.2.2.2.2.3.2.2.cmml">e</mi><mi id="A2.T1.39.39.1.m1.2.2.2.2.3.2.3" xref="A2.T1.39.39.1.m1.2.2.2.2.3.2.3.cmml">i</mi></msub><mo id="A2.T1.39.39.1.m1.2.2.2.2.3.1" xref="A2.T1.39.39.1.m1.2.2.2.2.3.1.cmml">âˆˆ</mo><mi class="ltx_font_mathcaligraphic" id="A2.T1.39.39.1.m1.2.2.2.2.3.3" xref="A2.T1.39.39.1.m1.2.2.2.2.3.3.cmml">â„°</mi></mrow></msub><msup id="A2.T1.39.39.1.m1.2.2.2.1" xref="A2.T1.39.39.1.m1.2.2.2.1.cmml"><mrow id="A2.T1.39.39.1.m1.2.2.2.1.1.1" xref="A2.T1.39.39.1.m1.2.2.2.1.1.2.cmml"><mo id="A2.T1.39.39.1.m1.2.2.2.1.1.1.2" xref="A2.T1.39.39.1.m1.2.2.2.1.1.2.1.cmml">â€–</mo><mrow id="A2.T1.39.39.1.m1.2.2.2.1.1.1.1" xref="A2.T1.39.39.1.m1.2.2.2.1.1.1.1.cmml"><msub id="A2.T1.39.39.1.m1.2.2.2.1.1.1.1.2" xref="A2.T1.39.39.1.m1.2.2.2.1.1.1.1.2.cmml"><mi id="A2.T1.39.39.1.m1.2.2.2.1.1.1.1.2.2" xref="A2.T1.39.39.1.m1.2.2.2.1.1.1.1.2.2.cmml">e</mi><mi id="A2.T1.39.39.1.m1.2.2.2.1.1.1.1.2.3" xref="A2.T1.39.39.1.m1.2.2.2.1.1.1.1.2.3.cmml">i</mi></msub><mo id="A2.T1.39.39.1.m1.2.2.2.1.1.1.1.1" xref="A2.T1.39.39.1.m1.2.2.2.1.1.1.1.1.cmml">âˆ’</mo><msub id="A2.T1.39.39.1.m1.2.2.2.1.1.1.1.3" xref="A2.T1.39.39.1.m1.2.2.2.1.1.1.1.3.cmml"><mover accent="true" id="A2.T1.39.39.1.m1.2.2.2.1.1.1.1.3.2" xref="A2.T1.39.39.1.m1.2.2.2.1.1.1.1.3.2.cmml"><mi id="A2.T1.39.39.1.m1.2.2.2.1.1.1.1.3.2.2" xref="A2.T1.39.39.1.m1.2.2.2.1.1.1.1.3.2.2.cmml">x</mi><mo id="A2.T1.39.39.1.m1.2.2.2.1.1.1.1.3.2.1" xref="A2.T1.39.39.1.m1.2.2.2.1.1.1.1.3.2.1.cmml">Â¯</mo></mover><mn id="A2.T1.39.39.1.m1.2.2.2.1.1.1.1.3.3" xref="A2.T1.39.39.1.m1.2.2.2.1.1.1.1.3.3.cmml">1</mn></msub></mrow><mo id="A2.T1.39.39.1.m1.2.2.2.1.1.1.3" xref="A2.T1.39.39.1.m1.2.2.2.1.1.2.1.cmml">â€–</mo></mrow><mn id="A2.T1.39.39.1.m1.2.2.2.1.3" xref="A2.T1.39.39.1.m1.2.2.2.1.3.cmml">2</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.T1.39.39.1.m1.2b"><apply id="A2.T1.39.39.1.m1.2.2.cmml" xref="A2.T1.39.39.1.m1.2.2"><eq id="A2.T1.39.39.1.m1.2.2.3.cmml" xref="A2.T1.39.39.1.m1.2.2.3"></eq><apply id="A2.T1.39.39.1.m1.1.1.1.cmml" xref="A2.T1.39.39.1.m1.1.1.1"><times id="A2.T1.39.39.1.m1.1.1.1.2.cmml" xref="A2.T1.39.39.1.m1.1.1.1.2"></times><ci id="A2.T1.39.39.1.m1.1.1.1.3.cmml" xref="A2.T1.39.39.1.m1.1.1.1.3">ğ‘”</ci><apply id="A2.T1.39.39.1.m1.1.1.1.1.1.1.cmml" xref="A2.T1.39.39.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.T1.39.39.1.m1.1.1.1.1.1.1.1.cmml" xref="A2.T1.39.39.1.m1.1.1.1.1.1">subscript</csymbol><apply id="A2.T1.39.39.1.m1.1.1.1.1.1.1.2.cmml" xref="A2.T1.39.39.1.m1.1.1.1.1.1.1.2"><ci id="A2.T1.39.39.1.m1.1.1.1.1.1.1.2.1.cmml" xref="A2.T1.39.39.1.m1.1.1.1.1.1.1.2.1">Â¯</ci><ci id="A2.T1.39.39.1.m1.1.1.1.1.1.1.2.2.cmml" xref="A2.T1.39.39.1.m1.1.1.1.1.1.1.2.2">ğ‘¥</ci></apply><cn id="A2.T1.39.39.1.m1.1.1.1.1.1.1.3.cmml" type="integer" xref="A2.T1.39.39.1.m1.1.1.1.1.1.1.3">1</cn></apply></apply><apply id="A2.T1.39.39.1.m1.2.2.2.cmml" xref="A2.T1.39.39.1.m1.2.2.2"><apply id="A2.T1.39.39.1.m1.2.2.2.2.cmml" xref="A2.T1.39.39.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="A2.T1.39.39.1.m1.2.2.2.2.1.cmml" xref="A2.T1.39.39.1.m1.2.2.2.2">subscript</csymbol><ci id="A2.T1.39.39.1.m1.2.2.2.2.2.cmml" xref="A2.T1.39.39.1.m1.2.2.2.2.2">argmin</ci><apply id="A2.T1.39.39.1.m1.2.2.2.2.3.cmml" xref="A2.T1.39.39.1.m1.2.2.2.2.3"><in id="A2.T1.39.39.1.m1.2.2.2.2.3.1.cmml" xref="A2.T1.39.39.1.m1.2.2.2.2.3.1"></in><apply id="A2.T1.39.39.1.m1.2.2.2.2.3.2.cmml" xref="A2.T1.39.39.1.m1.2.2.2.2.3.2"><csymbol cd="ambiguous" id="A2.T1.39.39.1.m1.2.2.2.2.3.2.1.cmml" xref="A2.T1.39.39.1.m1.2.2.2.2.3.2">subscript</csymbol><ci id="A2.T1.39.39.1.m1.2.2.2.2.3.2.2.cmml" xref="A2.T1.39.39.1.m1.2.2.2.2.3.2.2">ğ‘’</ci><ci id="A2.T1.39.39.1.m1.2.2.2.2.3.2.3.cmml" xref="A2.T1.39.39.1.m1.2.2.2.2.3.2.3">ğ‘–</ci></apply><ci id="A2.T1.39.39.1.m1.2.2.2.2.3.3.cmml" xref="A2.T1.39.39.1.m1.2.2.2.2.3.3">â„°</ci></apply></apply><apply id="A2.T1.39.39.1.m1.2.2.2.1.cmml" xref="A2.T1.39.39.1.m1.2.2.2.1"><csymbol cd="ambiguous" id="A2.T1.39.39.1.m1.2.2.2.1.2.cmml" xref="A2.T1.39.39.1.m1.2.2.2.1">superscript</csymbol><apply id="A2.T1.39.39.1.m1.2.2.2.1.1.2.cmml" xref="A2.T1.39.39.1.m1.2.2.2.1.1.1"><csymbol cd="latexml" id="A2.T1.39.39.1.m1.2.2.2.1.1.2.1.cmml" xref="A2.T1.39.39.1.m1.2.2.2.1.1.1.2">norm</csymbol><apply id="A2.T1.39.39.1.m1.2.2.2.1.1.1.1.cmml" xref="A2.T1.39.39.1.m1.2.2.2.1.1.1.1"><minus id="A2.T1.39.39.1.m1.2.2.2.1.1.1.1.1.cmml" xref="A2.T1.39.39.1.m1.2.2.2.1.1.1.1.1"></minus><apply id="A2.T1.39.39.1.m1.2.2.2.1.1.1.1.2.cmml" xref="A2.T1.39.39.1.m1.2.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="A2.T1.39.39.1.m1.2.2.2.1.1.1.1.2.1.cmml" xref="A2.T1.39.39.1.m1.2.2.2.1.1.1.1.2">subscript</csymbol><ci id="A2.T1.39.39.1.m1.2.2.2.1.1.1.1.2.2.cmml" xref="A2.T1.39.39.1.m1.2.2.2.1.1.1.1.2.2">ğ‘’</ci><ci id="A2.T1.39.39.1.m1.2.2.2.1.1.1.1.2.3.cmml" xref="A2.T1.39.39.1.m1.2.2.2.1.1.1.1.2.3">ğ‘–</ci></apply><apply id="A2.T1.39.39.1.m1.2.2.2.1.1.1.1.3.cmml" xref="A2.T1.39.39.1.m1.2.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.T1.39.39.1.m1.2.2.2.1.1.1.1.3.1.cmml" xref="A2.T1.39.39.1.m1.2.2.2.1.1.1.1.3">subscript</csymbol><apply id="A2.T1.39.39.1.m1.2.2.2.1.1.1.1.3.2.cmml" xref="A2.T1.39.39.1.m1.2.2.2.1.1.1.1.3.2"><ci id="A2.T1.39.39.1.m1.2.2.2.1.1.1.1.3.2.1.cmml" xref="A2.T1.39.39.1.m1.2.2.2.1.1.1.1.3.2.1">Â¯</ci><ci id="A2.T1.39.39.1.m1.2.2.2.1.1.1.1.3.2.2.cmml" xref="A2.T1.39.39.1.m1.2.2.2.1.1.1.1.3.2.2">ğ‘¥</ci></apply><cn id="A2.T1.39.39.1.m1.2.2.2.1.1.1.1.3.3.cmml" type="integer" xref="A2.T1.39.39.1.m1.2.2.2.1.1.1.1.3.3">1</cn></apply></apply></apply><cn id="A2.T1.39.39.1.m1.2.2.2.1.3.cmml" type="integer" xref="A2.T1.39.39.1.m1.2.2.2.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.39.39.1.m1.2c">g(\bar{x}_{1})=\operatorname*{argmin}_{e_{i}\in{\mathcal{E}}}\left\|e_{i}-\bar%
{x}_{1}\right\|^{2}</annotation><annotation encoding="application/x-llamapun" id="A2.T1.39.39.1.m1.2d">italic_g ( overÂ¯ start_ARG italic_x end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) = roman_argmin start_POSTSUBSCRIPT italic_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âˆˆ caligraphic_E end_POSTSUBSCRIPT âˆ¥ italic_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - overÂ¯ start_ARG italic_x end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT âˆ¥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="A2.T1.41.41">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T1.40.40.1"><math alttext="g(\cdot)" class="ltx_Math" display="inline" id="A2.T1.40.40.1.m1.1"><semantics id="A2.T1.40.40.1.m1.1a"><mrow id="A2.T1.40.40.1.m1.1.2" xref="A2.T1.40.40.1.m1.1.2.cmml"><mi id="A2.T1.40.40.1.m1.1.2.2" xref="A2.T1.40.40.1.m1.1.2.2.cmml">g</mi><mo id="A2.T1.40.40.1.m1.1.2.1" xref="A2.T1.40.40.1.m1.1.2.1.cmml">â¢</mo><mrow id="A2.T1.40.40.1.m1.1.2.3.2" xref="A2.T1.40.40.1.m1.1.2.cmml"><mo id="A2.T1.40.40.1.m1.1.2.3.2.1" stretchy="false" xref="A2.T1.40.40.1.m1.1.2.cmml">(</mo><mo id="A2.T1.40.40.1.m1.1.1" lspace="0em" rspace="0em" xref="A2.T1.40.40.1.m1.1.1.cmml">â‹…</mo><mo id="A2.T1.40.40.1.m1.1.2.3.2.2" stretchy="false" xref="A2.T1.40.40.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.T1.40.40.1.m1.1b"><apply id="A2.T1.40.40.1.m1.1.2.cmml" xref="A2.T1.40.40.1.m1.1.2"><times id="A2.T1.40.40.1.m1.1.2.1.cmml" xref="A2.T1.40.40.1.m1.1.2.1"></times><ci id="A2.T1.40.40.1.m1.1.2.2.cmml" xref="A2.T1.40.40.1.m1.1.2.2">ğ‘”</ci><ci id="A2.T1.40.40.1.m1.1.1.cmml" xref="A2.T1.40.40.1.m1.1.1">â‹…</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.40.40.1.m1.1c">g(\cdot)</annotation><annotation encoding="application/x-llamapun" id="A2.T1.40.40.1.m1.1d">italic_g ( â‹… )</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="A2.T1.41.41.2">maps prompt to a <math alttext="d" class="ltx_Math" display="inline" id="A2.T1.41.41.2.m1.1"><semantics id="A2.T1.41.41.2.m1.1a"><mi id="A2.T1.41.41.2.m1.1.1" xref="A2.T1.41.41.2.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="A2.T1.41.41.2.m1.1b"><ci id="A2.T1.41.41.2.m1.1.1.cmml" xref="A2.T1.41.41.2.m1.1.1">ğ‘‘</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.41.41.2.m1.1c">d</annotation><annotation encoding="application/x-llamapun" id="A2.T1.41.41.2.m1.1d">italic_d</annotation></semantics></math>-dimensional embedding vector</td>
</tr>
<tr class="ltx_tr" id="A2.T1.44.44">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T1.42.42.1"><math alttext="{f_{\text{dec}}}(\cdot,\cdot)" class="ltx_Math" display="inline" id="A2.T1.42.42.1.m1.2"><semantics id="A2.T1.42.42.1.m1.2a"><mrow id="A2.T1.42.42.1.m1.2.3" xref="A2.T1.42.42.1.m1.2.3.cmml"><msub id="A2.T1.42.42.1.m1.2.3.2" xref="A2.T1.42.42.1.m1.2.3.2.cmml"><mi id="A2.T1.42.42.1.m1.2.3.2.2" xref="A2.T1.42.42.1.m1.2.3.2.2.cmml">f</mi><mtext id="A2.T1.42.42.1.m1.2.3.2.3" xref="A2.T1.42.42.1.m1.2.3.2.3a.cmml">dec</mtext></msub><mo id="A2.T1.42.42.1.m1.2.3.1" xref="A2.T1.42.42.1.m1.2.3.1.cmml">â¢</mo><mrow id="A2.T1.42.42.1.m1.2.3.3.2" xref="A2.T1.42.42.1.m1.2.3.3.1.cmml"><mo id="A2.T1.42.42.1.m1.2.3.3.2.1" stretchy="false" xref="A2.T1.42.42.1.m1.2.3.3.1.cmml">(</mo><mo id="A2.T1.42.42.1.m1.1.1" lspace="0em" rspace="0em" xref="A2.T1.42.42.1.m1.1.1.cmml">â‹…</mo><mo id="A2.T1.42.42.1.m1.2.3.3.2.2" rspace="0em" xref="A2.T1.42.42.1.m1.2.3.3.1.cmml">,</mo><mo id="A2.T1.42.42.1.m1.2.2" lspace="0em" rspace="0em" xref="A2.T1.42.42.1.m1.2.2.cmml">â‹…</mo><mo id="A2.T1.42.42.1.m1.2.3.3.2.3" stretchy="false" xref="A2.T1.42.42.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.T1.42.42.1.m1.2b"><apply id="A2.T1.42.42.1.m1.2.3.cmml" xref="A2.T1.42.42.1.m1.2.3"><times id="A2.T1.42.42.1.m1.2.3.1.cmml" xref="A2.T1.42.42.1.m1.2.3.1"></times><apply id="A2.T1.42.42.1.m1.2.3.2.cmml" xref="A2.T1.42.42.1.m1.2.3.2"><csymbol cd="ambiguous" id="A2.T1.42.42.1.m1.2.3.2.1.cmml" xref="A2.T1.42.42.1.m1.2.3.2">subscript</csymbol><ci id="A2.T1.42.42.1.m1.2.3.2.2.cmml" xref="A2.T1.42.42.1.m1.2.3.2.2">ğ‘“</ci><ci id="A2.T1.42.42.1.m1.2.3.2.3a.cmml" xref="A2.T1.42.42.1.m1.2.3.2.3"><mtext id="A2.T1.42.42.1.m1.2.3.2.3.cmml" mathsize="70%" xref="A2.T1.42.42.1.m1.2.3.2.3">dec</mtext></ci></apply><interval closure="open" id="A2.T1.42.42.1.m1.2.3.3.1.cmml" xref="A2.T1.42.42.1.m1.2.3.3.2"><ci id="A2.T1.42.42.1.m1.1.1.cmml" xref="A2.T1.42.42.1.m1.1.1">â‹…</ci><ci id="A2.T1.42.42.1.m1.2.2.cmml" xref="A2.T1.42.42.1.m1.2.2">â‹…</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.42.42.1.m1.2c">{f_{\text{dec}}}(\cdot,\cdot)</annotation><annotation encoding="application/x-llamapun" id="A2.T1.42.42.1.m1.2d">italic_f start_POSTSUBSCRIPT dec end_POSTSUBSCRIPT ( â‹… , â‹… )</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="A2.T1.44.44.3">decodes <math alttext="L/r" class="ltx_Math" display="inline" id="A2.T1.43.43.2.m1.1"><semantics id="A2.T1.43.43.2.m1.1a"><mrow id="A2.T1.43.43.2.m1.1.1" xref="A2.T1.43.43.2.m1.1.1.cmml"><mi id="A2.T1.43.43.2.m1.1.1.2" xref="A2.T1.43.43.2.m1.1.1.2.cmml">L</mi><mo id="A2.T1.43.43.2.m1.1.1.1" xref="A2.T1.43.43.2.m1.1.1.1.cmml">/</mo><mi id="A2.T1.43.43.2.m1.1.1.3" xref="A2.T1.43.43.2.m1.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="A2.T1.43.43.2.m1.1b"><apply id="A2.T1.43.43.2.m1.1.1.cmml" xref="A2.T1.43.43.2.m1.1.1"><divide id="A2.T1.43.43.2.m1.1.1.1.cmml" xref="A2.T1.43.43.2.m1.1.1.1"></divide><ci id="A2.T1.43.43.2.m1.1.1.2.cmml" xref="A2.T1.43.43.2.m1.1.1.2">ğ¿</ci><ci id="A2.T1.43.43.2.m1.1.1.3.cmml" xref="A2.T1.43.43.2.m1.1.1.3">ğ‘Ÿ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.43.43.2.m1.1c">L/r</annotation><annotation encoding="application/x-llamapun" id="A2.T1.43.43.2.m1.1d">italic_L / italic_r</annotation></semantics></math> quantized embedding vectors in <math alttext="{\mathcal{E}}" class="ltx_Math" display="inline" id="A2.T1.44.44.3.m2.1"><semantics id="A2.T1.44.44.3.m2.1a"><mi class="ltx_font_mathcaligraphic" id="A2.T1.44.44.3.m2.1.1" xref="A2.T1.44.44.3.m2.1.1.cmml">â„°</mi><annotation-xml encoding="MathML-Content" id="A2.T1.44.44.3.m2.1b"><ci id="A2.T1.44.44.3.m2.1.1.cmml" xref="A2.T1.44.44.3.m2.1.1">â„°</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.44.44.3.m2.1c">{\mathcal{E}}</annotation><annotation encoding="application/x-llamapun" id="A2.T1.44.44.3.m2.1d">caligraphic_E</annotation></semantics></math> back to text tokens,</td>
</tr>
<tr class="ltx_tr" id="A2.T1.45.45">
<th class="ltx_td ltx_th ltx_th_row ltx_border_bb" id="A2.T1.45.45.2"></th>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A2.T1.45.45.1">conditioning on prompt embedding generated by <math alttext="g(\cdot)" class="ltx_Math" display="inline" id="A2.T1.45.45.1.m1.1"><semantics id="A2.T1.45.45.1.m1.1a"><mrow id="A2.T1.45.45.1.m1.1.2" xref="A2.T1.45.45.1.m1.1.2.cmml"><mi id="A2.T1.45.45.1.m1.1.2.2" xref="A2.T1.45.45.1.m1.1.2.2.cmml">g</mi><mo id="A2.T1.45.45.1.m1.1.2.1" xref="A2.T1.45.45.1.m1.1.2.1.cmml">â¢</mo><mrow id="A2.T1.45.45.1.m1.1.2.3.2" xref="A2.T1.45.45.1.m1.1.2.cmml"><mo id="A2.T1.45.45.1.m1.1.2.3.2.1" stretchy="false" xref="A2.T1.45.45.1.m1.1.2.cmml">(</mo><mo id="A2.T1.45.45.1.m1.1.1" lspace="0em" rspace="0em" xref="A2.T1.45.45.1.m1.1.1.cmml">â‹…</mo><mo id="A2.T1.45.45.1.m1.1.2.3.2.2" stretchy="false" xref="A2.T1.45.45.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.T1.45.45.1.m1.1b"><apply id="A2.T1.45.45.1.m1.1.2.cmml" xref="A2.T1.45.45.1.m1.1.2"><times id="A2.T1.45.45.1.m1.1.2.1.cmml" xref="A2.T1.45.45.1.m1.1.2.1"></times><ci id="A2.T1.45.45.1.m1.1.2.2.cmml" xref="A2.T1.45.45.1.m1.1.2.2">ğ‘”</ci><ci id="A2.T1.45.45.1.m1.1.1.cmml" xref="A2.T1.45.45.1.m1.1.1">â‹…</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T1.45.45.1.m1.1c">g(\cdot)</annotation><annotation encoding="application/x-llamapun" id="A2.T1.45.45.1.m1.1d">italic_g ( â‹… )</annotation></semantics></math>
</td>
</tr>
</tbody>
</table>{{< /table-caption >}}
> ğŸ”¼ Table 4.3 presents a detailed comparison of the average number of tokens used in generated responses across different methods.  It shows that the proposed 'latent' approach significantly reduces the response length (by 17%) compared to the standard Chain-of-Thought (CoT) method, while simultaneously achieving superior performance (as shown in Table 4.2).  The table also demonstrates that while the iCoT method generates even shorter responses, its overall accuracy is substantially lower than the latent approach.  The percentage reduction in response length compared to CoT is also indicated for each method.
> <details>
> <summary>read the caption</summary>
> Table 4.3: The average number of tokens in the generated responses. Compared with the CoT baseline, our latent approach achieves an 17%percent1717\%17 % reduction in response length on average, while surpassing it in final performance according toÂ TableÂ 4.2. The iCoT method generates shorter responses than our approach, yet performs significantly worse, seeÂ TableÂ 4.2. â†“â†“\downarrowâ†“ -:â€…Trace length reduction rate compared with CoT.
> </details>

</details>




### Full paper

{{< gallery >}}
<img src="https://ai-paper-reviewer.com/2502.03275/1.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="https://ai-paper-reviewer.com/2502.03275/2.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="https://ai-paper-reviewer.com/2502.03275/3.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="https://ai-paper-reviewer.com/2502.03275/4.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="https://ai-paper-reviewer.com/2502.03275/5.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="https://ai-paper-reviewer.com/2502.03275/6.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="https://ai-paper-reviewer.com/2502.03275/7.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="https://ai-paper-reviewer.com/2502.03275/8.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="https://ai-paper-reviewer.com/2502.03275/9.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="https://ai-paper-reviewer.com/2502.03275/10.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="https://ai-paper-reviewer.com/2502.03275/11.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="https://ai-paper-reviewer.com/2502.03275/12.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="https://ai-paper-reviewer.com/2502.03275/13.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="https://ai-paper-reviewer.com/2502.03275/14.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="https://ai-paper-reviewer.com/2502.03275/15.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="https://ai-paper-reviewer.com/2502.03275/16.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="https://ai-paper-reviewer.com/2502.03275/17.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="https://ai-paper-reviewer.com/2502.03275/18.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
{{< /gallery >}}