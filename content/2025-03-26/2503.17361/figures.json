[{"figure_path": "https://arxiv.org/html/2503.17361/extracted/6300322/Figures/gumbel-flow-figure1.png", "caption": "Figure 1: Overview of Gumbel-Softmax Flow Matching. Gumbel-softmax transformations are applied to clean one-hot sequences for varying temperatures dependent on time. The embedded noisy distributions are passed into a parameterized flow or score model and error prediction model to predict the conditional flow velocity and score function.", "description": "This figure illustrates the Gumbel-Softmax Flow Matching method. It begins with clean, one-hot encoded biological sequences.  A time-dependent temperature parameter is introduced, gradually decreasing the temperature over time. At each time point, a Gumbel-softmax transformation is applied to the clean sequences, creating a noisy distribution of probabilities. This noisy distribution is then inputted to either a parameterized flow model or a score model. These models output a conditional flow velocity or score function, respectively, which guide the generation process toward the target (clean) sequences.  The entire process results in a transformation from a noisy distribution to a clean distribution concentrated at the desired sequence.", "section": "3 Gumbel-Softmax Flow Matching"}, {"figure_path": "https://arxiv.org/html/2503.17361/extracted/6300322/Figures/guidance.png", "caption": "Figure 2: Straight-Through Guided Flows (STGFlow). We compute the gradients of the classifier function with respect to M\ud835\udc40Mitalic_M discrete sequences sampled from the intermediate token distribution \ud835\udc31tsubscript\ud835\udc31\ud835\udc61\\mathbf{x}_{t}bold_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT, which act as a guided flow velocity that steers the unconditional trajectory towards sequences with optimal scores.", "description": "This figure illustrates the Straight-Through Guided Flows (STGFlow) method.  STGFlow uses a pre-trained classifier to guide the generation process without requiring additional classifier training during the generation process.  The process begins by sampling M discrete sequences from an intermediate token distribution,  represented as **x<sub>t</sub>**. Gradients of the classifier function are then computed with respect to these M sequences. These gradients act as a guiding force, modifying the unconditional velocity field to steer the generation process towards sequences that achieve optimal classifier scores.  In essence, STGFlow leverages straight-through gradient estimators to efficiently guide the generation towards high-scoring sequences during inference.", "section": "Straight-Through Guided Flows (STGFlow)"}, {"figure_path": "https://arxiv.org/html/2503.17361/extracted/6300322/Figures/proteins.png", "caption": "Figure 3: Predicted structures of de novo generated proteins from Gumbel-Softmax FM. The structures, pLDDT, pAE, and pTM scores are predicted with ESMFold [27]", "description": "This figure showcases three examples of protein structures generated using the Gumbel-Softmax Flow Matching method. Each structure is accompanied by its predicted pLDDT, pAE, and pTM scores, all generated using the ESMFold prediction model.  These metrics assess the quality of the predicted structures, with higher pLDDT scores indicating higher confidence in the prediction, lower pAE scores suggesting better accuracy in the relative positioning of amino acid residues, and higher pTM scores signifying a greater agreement with known protein structures.", "section": "De Novo Protein Sequence Design"}, {"figure_path": "https://arxiv.org/html/2503.17361/extracted/6300322/Figures/no-binder-targets.png", "caption": "Figure 4: Gumbel-Softmax FM generated peptide binders for three targets with no known binders. (A) 10101010 a.a. designed binder to JPH3 (structure generated with AlphaFold3) involved in Huntington\u2019s Disease-Like 2. (B) 10101010 a.a. designed binder to GFAP (PDB: 6A9P) involved in Alexander Disease. (C) 7777 a.a. designed binder to eIF2B (PDB: 6CAJ) involved in Vanishing White Matter Disease. Docked with AutoDock VINA and polar contacts within 3.53.53.53.5 \u00c5\u00a0are annotated. Additional targets are shown in Table 4.", "description": "This figure showcases three examples of novel peptide binders generated using the Gumbel-Softmax Flow Matching method.  Each panel (A, B, C) represents a different target protein associated with a rare disease: JPH3 (Huntington's Disease-Like 2), GFAP (Alexander Disease), and eIF2B (Vanishing White Matter Disease). For each target, the figure displays the 3D structure of the designed peptide binder, its amino acid sequence length (10 amino acids in A and B, 7 amino acids in C), and its binding interaction with the target protein (visualized via polar contacts within 3.5 \u00c5). The protein structures shown in (A) were produced using AlphaFold3 predictions, while panels (B) and (C) utilize existing PDB structures (6A9P and 6CAJ, respectively). These results highlight the method's capability to generate effective peptide binders for various disease-related targets without prior knowledge of existing binders, paving the way for potential therapeutic developments.  Further details about additional targets are provided in Table 4 of the paper.", "section": "Peptide Binder Design"}, {"figure_path": "https://arxiv.org/html/2503.17361/extracted/6300322/Figures/4ezn.png", "caption": "Figure 5: Comparison of existing and Gumbel-Softmax FM designed binder to protein 4EZN. AutoDock VINA docking score of the designed binder (\u22126.56.5-6.5- 6.5 kcal/mol; magenta) is lower than that of the existing binder (\u22124.14.1-4.1- 4.1 kcal/mol; green) indicating stronger binding affinity. Polar contacts within 3.53.53.53.5 \u00c5\u00a0are annotated. Additional comparisons of existing and designed binders are in Table 3.", "description": "Figure 5 displays a comparison of peptide binders for protein 4EZN, illustrating the performance of Gumbel-Softmax FM in designing novel binders. The figure shows two peptide binders docked to protein 4EZN: an existing binder (green) and a de novo designed binder generated by Gumbel-Softmax FM (magenta). Key features of the figure are the improved docking scores of the designed binder (-6.5 kcal/mol) compared to the existing binder (-4.1 kcal/mol), highlighting its stronger binding affinity. Additionally, crucial polar contacts (within 3.5 \u00c5) between the designed binder and protein 4EZN are annotated, providing insights into the binding interaction.  Further comparisons of existing and designed peptide binders for different proteins are provided in Table 3 of the paper.", "section": "Peptide Binder Design"}, {"figure_path": "https://arxiv.org/html/2503.17361/extracted/6300322/Figures/guidance-curves.png", "caption": "Figure 6: Predicted binding-affinity scores over iteration of Gumbel-Softmax FM guided with STGFlow for target-binding peptide generation. The predicted binding affinity is the mean regression scores of the M\ud835\udc40Mitalic_M discrete sequences sampled at each integration step. The gradients of the scores are used to compute the guided velocity.", "description": "This figure visualizes the performance of Gumbel-Softmax Flow Matching (FM), a generative model for peptide design, enhanced with Straight-Through Guided Flows (STGFlow).  The plots show how the predicted binding affinity of generated peptides changes over the course of the iterative generation process. Specifically, the model samples multiple (M) peptide sequences at each step, and their average predicted binding affinity is calculated and plotted.  Crucially, the gradients of these predicted affinities guide the model's next step, ensuring that the generation process is steered towards higher-affinity peptides.  The graphs illustrate this guided optimization, showing how the predicted affinity increases over the iterations, driven by the STGFlow mechanism.  Two specific target proteins, 3EQS and GFAP, are depicted, demonstrating the model's effectiveness for different targets.", "section": "Peptide Binder Design"}, {"figure_path": "https://arxiv.org/html/2503.17361/extracted/6300322/Figures/validation-loss.png", "caption": "Figure 7: Validation MSE loss over training step of simplex-dimension toy experiment. Fisher FM exhibits significantly higher validation MSE loss during training than Gumbel-Softmax FM despite the same loss calculation, suggesting that the parameterization easily overfits to training data.", "description": "This figure displays the validation mean squared error (MSE) loss during training for a toy experiment involving different simplex dimensions.  Two methods are compared: Fisher Flow Matching (FM) and Gumbel-Softmax FM.  Both methods used the same loss calculation, yet the Fisher FM model shows significantly higher validation MSE loss, indicating a tendency to overfit the training data.  This suggests that the parameterization used by Fisher FM is more prone to overfitting than the one used by Gumbel-Softmax FM.", "section": "Simplex-Dimension Toy Experiment"}, {"figure_path": "https://arxiv.org/html/2503.17361/extracted/6300322/Figures/no-binder-targets2.png", "caption": "Figure 8: Gumbel-Softmax FM generated peptide binders for three targets with no known binders. (A) 7 a.a. designed binder to NPC2 (PDB: 6W5V) involved in Niemann-Pick Disease Type C. (B) 10 a.a. designed binder to BMI1 (PDB: 2CKL) involved in Medulloblastoma. (C) 10 a.a. designed binder to Gigaxonin (PDB: 3HVE) involved in Giant Axonal Neuropathy. Docked with AutoDock VINA and polar contacts within 3.5 \u00c5\u00a0are annotated. Additional targets are shown in Table 4.", "description": "Figure 8 showcases three examples of novel peptide binders generated using the Gumbel-Softmax Flow Matching method.  These peptides target proteins associated with rare diseases, for which no known binders previously existed.  Each panel (A, B, C) highlights a different protein-peptide pair: (A) a 7-amino acid peptide binding to NPC2 (a protein involved in Niemann-Pick Disease Type C; PDB ID: 6W5V), (B) a 10-amino acid peptide binding to BMI1 (implicated in medulloblastoma; PDB ID: 2CKL), and (C) a 10-amino acid peptide binding to Gigaxonin (associated with Giant Axonal Neuropathy; PDB ID: 3HVE).  The figure illustrates the binding interactions using AutoDock Vina docking, showing polar contacts within 3.5 angstroms (\u00c5) of the binding site. Additional examples of generated peptide binders can be found in Table 4 of the paper.", "section": "Peptide Binder Design"}, {"figure_path": "https://arxiv.org/html/2503.17361/extracted/6300322/Figures/appendix-proteins.png", "caption": "Figure 9: Predicted structures of de novo generated proteins with Gumbel-Softmax FM. Generated proteins demonstrate diverse structural generation.", "description": "This figure shows the 3D structures of 20 de novo generated proteins predicted by the Gumbel-Softmax Flow Matching (FM) model. Each protein structure is displayed in a different orientation and coloring scheme, highlighting their structural diversity. The proteins show various shapes, sizes, and folds, demonstrating the model's ability to generate a wide range of diverse protein structures.", "section": "De Novo Protein Sequence Design"}]